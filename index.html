<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ° ë¡œë˜ 645 AI ì˜ˆì¸¡ ì‹œìŠ¤í…œ</title>
    <link href="https://fonts.googleapis.com/css2?family=Black+Han+Sans&family=Noto+Sans+KR:wght@300;400;500;700;900&family=Orbitron:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-dark: #0a0a1a; --bg-card: #12122a; --bg-card-hover: #1a1a3a;
            --accent-gold: #ffd700; --accent-cyan: #00f5ff; --accent-pink: #ff006e; --accent-purple: #8b5cf6;
            --text-primary: #ffffff; --text-secondary: #a0a0c0;
            --ball-yellow: linear-gradient(135deg, #ffd700, #ffed4a, #ffd700);
            --ball-blue: linear-gradient(135deg, #3b82f6, #60a5fa, #3b82f6);
            --ball-red: linear-gradient(135deg, #ef4444, #f87171, #ef4444);
            --ball-gray: linear-gradient(135deg, #374151, #6b7280, #374151);
            --ball-green: linear-gradient(135deg, #10b981, #34d399, #10b981);
            --ball-bonus: linear-gradient(135deg, #8b5cf6, #a78bfa, #8b5cf6);
            --grade-excellent: #10b981; --grade-good: #3b82f6; --grade-normal: #fbbf24; --grade-caution: #f97316; --grade-bad: #ef4444;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Noto Sans KR', sans-serif; background: var(--bg-dark); color: var(--text-primary); min-height: 100vh;
            background-image: radial-gradient(circle at 20% 80%, rgba(139,92,246,0.15) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(0,245,255,0.1) 0%, transparent 50%),
                radial-gradient(circle at 50% 50%, rgba(255,0,110,0.05) 0%, transparent 70%);
        }
        .container { max-width: 900px; margin: 0 auto; padding: 20px; }
        header { text-align: center; padding: 40px 20px; position: relative; }
        .title {
            font-family: 'Black Han Sans', sans-serif; font-size: clamp(2rem, 6vw, 3.5rem);
            background: linear-gradient(135deg, var(--accent-gold), var(--accent-cyan));
            -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;
            animation: titleGlow 3s ease-in-out infinite;
        }
        @keyframes titleGlow {
            0%, 100% { filter: drop-shadow(0 0 20px rgba(255,215,0,0.4)); }
            50% { filter: drop-shadow(0 0 30px rgba(0,245,255,0.6)); }
        }
        .card {
            background: var(--bg-card); border-radius: 20px; padding: 25px; margin-bottom: 20px;
            border: 1px solid rgba(255,255,255,0.05); box-shadow: 0 10px 40px rgba(0,0,0,0.3); transition: all 0.3s ease;
        }
        .card:hover { background: var(--bg-card-hover); border-color: rgba(139,92,246,0.3); }
        .card-header { display: flex; align-items: center; gap: 12px; margin-bottom: 20px; }
        .card-icon { width: 40px; height: 40px; border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 1.2rem; }
        .card-icon.gold { background: linear-gradient(135deg, #ffd700, #ff9500); }
        .card-icon.cyan { background: linear-gradient(135deg, #00f5ff, #00a0ff); }
        .card-title { font-family: 'Black Han Sans', sans-serif; font-size: 1.3rem; }
        .balls-container { display: flex; justify-content: center; flex-wrap: wrap; gap: 10px; padding: 20px 0; }
        .ball {
            width: 52px; height: 52px; border-radius: 50%; display: flex; align-items: center; justify-content: center;
            font-family: 'Orbitron', sans-serif; font-weight: 700; font-size: 1.1rem; color: #fff;
            box-shadow: 0 4px 15px rgba(0,0,0,0.4), inset 0 -3px 10px rgba(0,0,0,0.3), inset 0 3px 10px rgba(255,255,255,0.3);
            animation: ballPop 0.5s ease-out backwards; position: relative;
        }
        .ball::after { content: ''; position: absolute; top: 8px; left: 12px; width: 12px; height: 8px; background: rgba(255,255,255,0.5); border-radius: 50%; transform: rotate(-30deg); }
        .ball.yellow { background: var(--ball-yellow); color: #333; }
        .ball.blue { background: var(--ball-blue); }
        .ball.red { background: var(--ball-red); }
        .ball.gray { background: var(--ball-gray); }
        .ball.green { background: var(--ball-green); }
        .ball.bonus { background: var(--ball-bonus); }
        @keyframes ballPop { 0% { transform: scale(0) rotate(-180deg); opacity: 0; } 100% { transform: scale(1) rotate(0); opacity: 1; } }
        .ball:nth-child(1) { animation-delay: 0.1s; } .ball:nth-child(2) { animation-delay: 0.2s; } .ball:nth-child(3) { animation-delay: 0.3s; }
        .ball:nth-child(4) { animation-delay: 0.4s; } .ball:nth-child(5) { animation-delay: 0.5s; } .ball:nth-child(6) { animation-delay: 0.6s; } .ball:nth-child(8) { animation-delay: 0.8s; }
        .plus-sign { display: flex; align-items: center; font-size: 1.5rem; color: var(--accent-gold); padding: 0 5px; }
        .input-group { display: flex; gap: 10px; align-items: center; flex-wrap: wrap; }
        .input-field {
            flex: 1; min-width: 120px; padding: 15px 20px; border: 2px solid rgba(255,255,255,0.1); border-radius: 12px;
            background: rgba(0,0,0,0.3); color: var(--text-primary); font-size: 1.1rem; font-family: 'Orbitron', sans-serif; transition: all 0.3s ease;
        }
        .input-field:focus { outline: none; border-color: var(--accent-cyan); box-shadow: 0 0 20px rgba(0,245,255,0.3); }
        .btn { padding: 15px 30px; border: none; border-radius: 12px; font-family: 'Noto Sans KR', sans-serif; font-weight: 700; font-size: 1rem; cursor: pointer; transition: all 0.3s ease; display: inline-flex; align-items: center; gap: 8px; }
        .btn-primary { background: linear-gradient(135deg, var(--accent-cyan), var(--accent-purple)); color: white; box-shadow: 0 4px 20px rgba(0,245,255,0.3); }
        .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 8px 30px rgba(0,245,255,0.5); }
        .btn-primary:disabled { background: #444; cursor: not-allowed; transform: none; box-shadow: none; }
        .btn-secondary { background: rgba(255,255,255,0.1); color: var(--text-primary); border: 1px solid rgba(255,255,255,0.2); }
        .btn-gold { background: linear-gradient(135deg, #ffd700, #ff9500); color: #1a1a1a; box-shadow: 0 4px 20px rgba(255,215,0,0.3); }
        .btn-gold:hover { transform: translateY(-2px); box-shadow: 0 8px 30px rgba(255,215,0,0.5); }
        .status { padding: 15px 20px; border-radius: 12px; margin: 15px 0; display: flex; align-items: center; gap: 10px; }
        .status.success { background: rgba(16,185,129,0.2); border: 1px solid rgba(16,185,129,0.5); color: #34d399; }
        .status.error { background: rgba(239,68,68,0.2); border: 1px solid rgba(239,68,68,0.5); color: #f87171; }
        .status.info { background: rgba(59,130,246,0.2); border: 1px solid rgba(59,130,246,0.5); color: #60a5fa; }
        .status.warning { background: rgba(245,158,11,0.2); border: 1px solid rgba(245,158,11,0.5); color: #fbbf24; }
        .progress-container { width: 100%; height: 20px; background: rgba(0,0,0,0.3); border-radius: 10px; overflow: hidden; margin: 15px 0; }
        .progress-bar { height: 100%; background: linear-gradient(90deg, var(--accent-cyan), var(--accent-purple), var(--accent-pink)); background-size: 200% 100%; animation: progressGradient 2s linear infinite; transition: width 0.3s ease; border-radius: 10px; }
        @keyframes progressGradient { 0% { background-position: 0% 50%; } 100% { background-position: 200% 50%; } }
        .progress-text { font-family: 'Orbitron', sans-serif; font-size: 0.9rem; color: var(--accent-cyan); text-align: center; margin-top: 8px; }
        
        /* ê°œì„ ëœ ë¶„ì„ ê·¸ë¦¬ë“œ ìŠ¤íƒ€ì¼ */
        .analysis-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-top: 20px; }
        .analysis-item { 
            background: rgba(0,0,0,0.2); padding: 18px; border-radius: 12px; 
            border: 1px solid rgba(255,255,255,0.05); position: relative;
            transition: all 0.3s ease;
        }
        .analysis-item:hover { background: rgba(0,0,0,0.3); border-color: rgba(255,255,255,0.1); }
        .analysis-item.grade-excellent { border-left: 4px solid var(--grade-excellent); }
        .analysis-item.grade-good { border-left: 4px solid var(--grade-good); }
        .analysis-item.grade-normal { border-left: 4px solid var(--grade-normal); }
        .analysis-item.grade-caution { border-left: 4px solid var(--grade-caution); }
        .analysis-item.grade-bad { border-left: 4px solid var(--grade-bad); }
        
        .analysis-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px; }
        .analysis-label { font-size: 0.8rem; color: var(--text-secondary); text-transform: uppercase; letter-spacing: 1px; display: flex; align-items: center; gap: 6px; }
        .analysis-value { font-family: 'Orbitron', sans-serif; font-size: 1.5rem; color: var(--accent-cyan); margin: 5px 0; }
        .analysis-detail { font-size: 0.85rem; color: var(--text-secondary); margin-top: 8px; line-height: 1.5; }
        .analysis-badge { 
            font-size: 0.65rem; font-weight: 700; padding: 4px 8px; border-radius: 20px; 
            text-transform: uppercase; letter-spacing: 0.5px;
        }
        .badge-excellent { background: rgba(16,185,129,0.2); color: var(--grade-excellent); }
        .badge-good { background: rgba(59,130,246,0.2); color: var(--grade-good); }
        .badge-normal { background: rgba(251,191,36,0.2); color: var(--grade-normal); }
        .badge-caution { background: rgba(249,115,22,0.2); color: var(--grade-caution); }
        .badge-bad { background: rgba(239,68,68,0.2); color: var(--grade-bad); }
        
        /* ë„ì›€ë§ íˆ´íŒ */
        .help-icon {
            display: inline-flex; align-items: center; justify-content: center;
            width: 16px; height: 16px; border-radius: 50%;
            background: rgba(255,255,255,0.1); color: var(--text-secondary);
            font-size: 0.65rem; cursor: help; position: relative;
        }
        .help-icon:hover .tooltip { display: block; }
        .tooltip {
            display: none; position: absolute; bottom: 100%; left: 50%; transform: translateX(-50%);
            background: #1e1e3f; border: 1px solid rgba(255,255,255,0.2); border-radius: 8px;
            padding: 12px; width: 250px; font-size: 0.75rem; color: var(--text-primary);
            line-height: 1.5; z-index: 100; box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            margin-bottom: 8px;
        }
        .tooltip::after {
            content: ''; position: absolute; top: 100%; left: 50%; transform: translateX(-50%);
            border: 6px solid transparent; border-top-color: #1e1e3f;
        }
        .tooltip-title { font-weight: 700; color: var(--accent-cyan); margin-bottom: 6px; }
        
        /* ì¢…í•© ì ìˆ˜ ì¹´ë“œ */
        .score-card {
            background: linear-gradient(135deg, rgba(139,92,246,0.2), rgba(0,245,255,0.2));
            border: 1px solid rgba(139,92,246,0.3); border-radius: 16px;
            padding: 25px; margin: 20px 0; text-align: center;
        }
        .score-main {
            font-family: 'Orbitron', sans-serif; font-size: 3rem; font-weight: 900;
            background: linear-gradient(135deg, var(--accent-gold), var(--accent-cyan));
            -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;
        }
        .score-label { font-size: 0.9rem; color: var(--text-secondary); margin-top: 5px; }
        .score-breakdown { display: flex; justify-content: center; gap: 20px; margin-top: 20px; flex-wrap: wrap; }
        .score-item { text-align: center; padding: 10px 15px; background: rgba(0,0,0,0.2); border-radius: 10px; min-width: 80px; }
        .score-item-value { font-family: 'Orbitron', sans-serif; font-size: 1.2rem; }
        .score-item-label { font-size: 0.7rem; color: var(--text-secondary); margin-top: 3px; }
        
        /* í•´ì„ ë°•ìŠ¤ */
        .interpretation-box {
            background: rgba(0,0,0,0.2); border-radius: 12px; padding: 20px; margin-top: 20px;
            border-left: 4px solid var(--accent-purple);
        }
        .interpretation-title { font-weight: 700; color: var(--accent-gold); margin-bottom: 10px; display: flex; align-items: center; gap: 8px; }
        .interpretation-content { color: var(--text-secondary); line-height: 1.8; font-size: 0.9rem; }
        .interpretation-content strong { color: var(--text-primary); }
        
        /* ì‹œë®¬ë ˆì´ì…˜ í†µê³„ í•´ì„ */
        .sim-interpretation {
            background: linear-gradient(135deg, rgba(16,185,129,0.1), rgba(59,130,246,0.1));
            border: 1px solid rgba(16,185,129,0.3); border-radius: 12px;
            padding: 20px; margin-top: 20px;
        }
        .sim-interpretation h4 { color: var(--accent-cyan); margin-bottom: 15px; }
        .sim-stat-row { display: flex; justify-content: space-between; padding: 10px 0; border-bottom: 1px solid rgba(255,255,255,0.05); }
        .sim-stat-row:last-child { border-bottom: none; }
        .sim-stat-label { color: var(--text-secondary); }
        .sim-stat-value { font-family: 'Orbitron', sans-serif; color: var(--accent-gold); }
        .sim-stat-note { font-size: 0.8rem; color: var(--text-secondary); margin-top: 5px; }
        
        .stats-row { display: flex; flex-wrap: wrap; gap: 20px; justify-content: center; margin: 20px 0; }
        .stat-item { text-align: center; padding: 15px 25px; background: rgba(0,0,0,0.2); border-radius: 12px; min-width: 100px; position: relative; }
        .stat-value { font-family: 'Orbitron', sans-serif; font-size: 1.5rem; color: var(--accent-gold); }
        .stat-label { font-size: 0.75rem; color: var(--text-secondary); margin-top: 5px; }
        .stat-help { position: absolute; top: 8px; right: 8px; }
        
        .number-grid { display: grid; grid-template-columns: repeat(9, 1fr); gap: 8px; margin: 20px 0; }
        @media (max-width: 600px) { .number-grid { grid-template-columns: repeat(5, 1fr); } }
        .number-btn { aspect-ratio: 1; border: 2px solid rgba(255,255,255,0.1); border-radius: 10px; background: rgba(0,0,0,0.3); color: var(--text-primary); font-family: 'Orbitron', sans-serif; font-weight: 700; font-size: 0.9rem; cursor: pointer; transition: all 0.2s ease; }
        .number-btn:hover { background: rgba(255,255,255,0.1); border-color: rgba(255,255,255,0.3); }
        .number-btn.selected { transform: scale(1.1); box-shadow: 0 0 15px currentColor; }
        .number-btn.selected.yellow { background: var(--ball-yellow); color: #333; border-color: #ffd700; }
        .number-btn.selected.blue { background: var(--ball-blue); border-color: #3b82f6; }
        .number-btn.selected.red { background: var(--ball-red); border-color: #ef4444; }
        .number-btn.selected.gray { background: var(--ball-gray); border-color: #6b7280; }
        .number-btn.selected.green { background: var(--ball-green); border-color: #10b981; }
        .collapsible { background: rgba(0,0,0,0.2); border-radius: 12px; margin-top: 15px; overflow: hidden; }
        .collapsible-header { padding: 15px 20px; cursor: pointer; display: flex; justify-content: space-between; align-items: center; transition: background 0.3s ease; }
        .collapsible-header:hover { background: rgba(255,255,255,0.05); }
        .collapsible-content { padding: 0 20px 20px; display: none; }
        .collapsible.open .collapsible-content { display: block; }
        .collapsible-icon { transition: transform 0.3s ease; }
        .collapsible.open .collapsible-icon { transform: rotate(180deg); }
        .portal-result { display: flex; align-items: center; gap: 10px; padding: 10px; margin: 5px 0; background: rgba(0,0,0,0.2); border-radius: 8px; }
        .portal-name { font-weight: 700; min-width: 60px; }
        .portal-status { font-size: 1.2rem; }
        .match-highlight { background: linear-gradient(135deg, rgba(16,185,129,0.3), rgba(52,211,153,0.3)); border: 2px solid #10b981; padding: 15px; border-radius: 12px; text-align: center; margin-top: 20px; }
        .match-count { font-family: 'Orbitron', sans-serif; font-size: 2rem; color: #34d399; }
        .sponsor-box { background: linear-gradient(135deg, rgba(139,92,246,0.3), rgba(255,0,110,0.3)); border: 1px solid rgba(139,92,246,0.5); border-radius: 20px; padding: 30px; text-align: center; margin-top: 30px; }
        .sponsor-title { font-family: 'Black Han Sans', sans-serif; font-size: 1.5rem; color: var(--accent-gold); margin-bottom: 15px; }
        .sponsor-name { font-size: 1.2rem; font-weight: 700; margin-bottom: 10px; }
        .sponsor-account { font-family: 'Orbitron', sans-serif; font-size: 1.3rem; color: var(--accent-cyan); background: rgba(0,0,0,0.3); padding: 15px 25px; border-radius: 12px; display: inline-block; }
        .sim-controls { display: flex; gap: 15px; flex-wrap: wrap; align-items: center; justify-content: center; margin: 20px 0; }
        .sim-input { width: 150px; padding: 12px 15px; border: 2px solid rgba(255,255,255,0.1); border-radius: 10px; background: rgba(0,0,0,0.3); color: var(--text-primary); font-family: 'Orbitron', sans-serif; font-size: 1rem; }
        .sim-input:focus { outline: none; border-color: var(--accent-purple); }
        .hidden { display: none !important; }
        .section-bar { display: flex; gap: 3px; margin-top: 10px; }
        .section-segment { flex: 1; height: 35px; border-radius: 5px; display: flex; align-items: center; justify-content: center; font-size: 0.8rem; font-weight: 700; opacity: 0.3; transition: all 0.3s ease; flex-direction: column; }
        .section-segment.active { opacity: 1; transform: scaleY(1.1); }
        .section-segment.s1 { background: var(--ball-yellow); color: #333; }
        .section-segment.s2 { background: var(--ball-blue); }
        .section-segment.s3 { background: var(--ball-red); }
        .section-segment.s4 { background: var(--ball-gray); }
        .section-segment.s5 { background: var(--ball-green); }
        .discovery-animation { animation: discovery 0.5s ease-out; }
        @keyframes discovery { 0% { transform: scale(0.8); opacity: 0; } 50% { transform: scale(1.1); } 100% { transform: scale(1); opacity: 1; } }
        .prediction-list { 
            max-height: 800px; overflow-y: auto; margin-top: 15px; 
            -webkit-overflow-scrolling: touch; /* iOS ìŠ¤í¬ë¡¤ ê°œì„  */
            overscroll-behavior: contain;
        }
        .prediction-item { background: rgba(0,0,0,0.2); border-radius: 12px; padding: 15px; margin-bottom: 10px; border-left: 4px solid var(--accent-purple); }
        .prediction-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
        .prediction-number { font-family: 'Orbitron', sans-serif; color: var(--accent-gold); }
        .prediction-meta { font-size: 0.8rem; color: var(--text-secondary); }
        
        /* ë‹¹ì²¨ ë“±ê¸‰ ì •ë³´ */
        .prize-info {
            background: rgba(0,0,0,0.2); border-radius: 12px; padding: 20px; margin-top: 20px;
        }
        .prize-info h4 { color: var(--accent-gold); margin-bottom: 15px; }
        .prize-table { width: 100%; border-collapse: collapse; }
        .prize-table th, .prize-table td { padding: 10px; text-align: center; border-bottom: 1px solid rgba(255,255,255,0.05); }
        .prize-table th { color: var(--text-secondary); font-size: 0.8rem; }
        .prize-table td { font-family: 'Orbitron', sans-serif; }
        .prize-rank { color: var(--accent-gold); }
        .prize-condition { color: var(--text-secondary); font-size: 0.85rem; }
        .prize-prob { color: var(--accent-cyan); }
        
        /* ë°œê²¬ëœ ì˜ˆì¸¡ ë²ˆí˜¸ ìƒì„¸ ë¶„ì„ ìŠ¤íƒ€ì¼ */
        .prediction-item-expanded { margin-bottom: 20px; }
        
        .pred-card {
            background: var(--bg-card); border-radius: 16px; overflow: hidden;
            border: 1px solid rgba(255,255,255,0.08); transition: all 0.3s ease;
        }
        .pred-card:hover { border-color: rgba(139,92,246,0.4); box-shadow: 0 8px 30px rgba(0,0,0,0.3); }
        
        .pred-card-header {
            padding: 15px 20px; background: rgba(0,0,0,0.2); cursor: pointer;
            display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 10px;
            -webkit-tap-highlight-color: rgba(139,92,246,0.3); touch-action: manipulation; user-select: none;
            position: relative; z-index: 10;
        }
        .pred-card-header:active { background: rgba(0,0,0,0.35); }
        .pred-card-title { display: flex; align-items: center; gap: 10px; flex-wrap: wrap; }
        .pred-card-meta { display: flex; align-items: center; gap: 8px; font-size: 0.8rem; color: var(--text-secondary); }
        
        .pred-score-badge {
            font-size: 0.75rem; font-weight: 700; padding: 4px 10px; border-radius: 15px;
        }
        .pred-score-badge.score-excellent { background: rgba(16,185,129,0.2); color: var(--grade-excellent); }
        .pred-score-badge.score-good { background: rgba(59,130,246,0.2); color: var(--grade-good); }
        .pred-score-badge.score-normal { background: rgba(251,191,36,0.2); color: var(--grade-normal); }
        .pred-score-badge.score-caution { background: rgba(249,115,22,0.2); color: var(--grade-caution); }
        .pred-score-badge.score-bad { background: rgba(239,68,68,0.2); color: var(--grade-bad); }
        
        .pred-grade-badge {
            font-size: 0.7rem; font-weight: 700; padding: 3px 8px; border-radius: 12px;
        }
        .pred-grade-badge.grade-jackpot { background: linear-gradient(135deg, #ffd700, #ff9500); color: #1a1a1a; }
        .pred-grade-badge.grade-high { background: rgba(16,185,129,0.3); color: #34d399; }
        .pred-grade-badge.grade-mid { background: rgba(59,130,246,0.3); color: #60a5fa; }
        .pred-grade-badge.grade-low { background: rgba(139,92,246,0.3); color: #a78bfa; }
        
        .expand-icon { transition: transform 0.3s ease; font-size: 0.8rem; }
        
        .pred-balls-row { display: flex; justify-content: center; gap: 8px; padding: 20px; flex-wrap: wrap; }
        
        .pred-match-info {
            display: flex; align-items: center; justify-content: center; gap: 10px;
            padding: 12px; background: rgba(16,185,129,0.15); border-top: 1px solid rgba(16,185,129,0.3);
            font-size: 0.9rem; flex-wrap: wrap;
        }
        .pred-match-info.no-match { background: rgba(100,100,100,0.1); border-top-color: rgba(100,100,100,0.2); color: var(--text-secondary); }
        .match-label { color: #34d399; }
        .match-numbers { font-family: 'Orbitron', sans-serif; color: var(--accent-cyan); }
        .match-count-badge { background: #10b981; color: white; padding: 2px 8px; border-radius: 10px; font-size: 0.8rem; font-weight: 700; }
        
        .pred-quick-stats {
            display: flex; justify-content: center; gap: 15px; padding: 15px;
            background: rgba(0,0,0,0.15); flex-wrap: wrap;
        }
        .quick-stat { text-align: center; min-width: 60px; }
        .quick-stat-label { font-size: 0.7rem; color: var(--text-secondary); display: block; }
        .quick-stat-value { font-family: 'Orbitron', sans-serif; font-size: 1rem; color: var(--accent-cyan); }
        
        .pred-detail-section {
            background: rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .pred-toggle-btn {
            width: 100%; padding: 8px; border: none; background: rgba(139,92,246,0.2);
            color: var(--accent-purple); font-weight: 600; cursor: pointer; transition: all 0.3s ease;
            font-size: 0.8rem; -webkit-tap-highlight-color: rgba(139,92,246,0.3); touch-action: manipulation;
            user-select: none; -webkit-user-select: none; position: relative; z-index: 10;
        }
        .pred-toggle-btn:hover, .pred-toggle-btn:active { background: rgba(139,92,246,0.4); }
        
        /* ìƒì„¸ ë¶„ì„ ë‚´ë¶€ ìŠ¤íƒ€ì¼ */
        .detail-section { margin-bottom: 20px; padding-bottom: 20px; border-bottom: 1px solid rgba(255,255,255,0.05); }
        .detail-section:last-child { border-bottom: none; margin-bottom: 0; padding-bottom: 0; }
        .detail-title { font-weight: 700; color: var(--accent-cyan); margin-bottom: 12px; display: flex; align-items: center; gap: 8px; }
        
        .score-breakdown-detail { display: flex; flex-direction: column; gap: 10px; }
        .score-bar-item { }
        .score-bar-header { display: flex; justify-content: space-between; font-size: 0.85rem; margin-bottom: 4px; }
        .score-bar-bg { height: 8px; background: rgba(0,0,0,0.3); border-radius: 4px; overflow: hidden; }
        .score-bar-fill { height: 100%; border-radius: 4px; transition: width 0.5s ease; }
        
        .detail-interpretation {
            background: rgba(0,0,0,0.2); padding: 15px; border-radius: 10px;
            font-size: 0.9rem; color: var(--text-secondary); line-height: 1.6;
        }
        .detail-interpretation strong { color: var(--text-primary); }
        
        .detail-metrics-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap: 12px; }
        .detail-metric {
            background: rgba(0,0,0,0.2); padding: 12px; border-radius: 10px;
            border-left: 3px solid var(--accent-purple);
        }
        .metric-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 5px; }
        .metric-label { font-size: 0.8rem; color: var(--text-secondary); }
        .metric-grade { font-size: 0.65rem; padding: 2px 6px; border-radius: 8px; }
        .metric-value { font-family: 'Orbitron', sans-serif; font-size: 1.4rem; color: var(--accent-gold); }
        .metric-range { font-size: 0.75rem; color: var(--text-secondary); margin-top: 3px; }
        .metric-detail { font-size: 0.8rem; margin-top: 5px; }
        
        .dual-analysis { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; }
        .dual-box { background: rgba(0,0,0,0.2); padding: 15px; border-radius: 10px; }
        .dual-header { font-size: 0.85rem; color: var(--text-secondary); margin-bottom: 8px; display: flex; justify-content: space-between; align-items: center; }
        .dual-ratio { font-family: 'Orbitron', sans-serif; font-size: 1.5rem; color: var(--accent-gold); margin-bottom: 10px; }
        .dual-detail { font-size: 0.85rem; line-height: 1.6; }
        
        .section-visual { }
        .section-bar-detail { display: flex; gap: 4px; margin-bottom: 10px; }
        .section-seg {
            flex: 1; padding: 10px 5px; border-radius: 8px; text-align: center;
            opacity: 0.3; transition: all 0.3s ease;
        }
        .section-seg.active { opacity: 1; }
        .section-seg.s1 { background: var(--ball-yellow); color: #333; }
        .section-seg.s2 { background: var(--ball-blue); color: white; }
        .section-seg.s3 { background: var(--ball-red); color: white; }
        .section-seg.s4 { background: var(--ball-gray); color: white; }
        .section-seg.s5 { background: var(--ball-green); color: white; }
        .seg-count { font-family: 'Orbitron', sans-serif; font-size: 1.2rem; display: block; }
        .seg-label { font-size: 0.65rem; }
        .section-numbers { display: flex; flex-wrap: wrap; gap: 8px; margin-top: 10px; }
        .section-num-item { font-size: 0.8rem; background: rgba(0,0,0,0.2); padding: 4px 10px; border-radius: 15px; }
        
        .consecutive-groups { display: flex; flex-wrap: wrap; gap: 8px; }
        .consec-group {
            background: rgba(139,92,246,0.2); border: 1px solid rgba(139,92,246,0.4);
            padding: 5px 12px; border-radius: 15px; font-family: 'Orbitron', sans-serif; font-size: 0.9rem;
        }
        .gap-stats { display: flex; gap: 15px; font-size: 0.9rem; margin-bottom: 8px; flex-wrap: wrap; }
        .gap-stats strong { color: var(--accent-cyan); }
        .gap-sequence { font-size: 0.85rem; color: var(--text-secondary); }
        
        .math-props { display: flex; flex-direction: column; gap: 10px; }
        .math-item { display: flex; justify-content: space-between; padding: 8px 12px; background: rgba(0,0,0,0.2); border-radius: 8px; }
        .math-label { color: var(--text-secondary); font-size: 0.85rem; }
        .math-value { color: var(--accent-cyan); font-size: 0.85rem; }
        
        .prize-section { background: linear-gradient(135deg, rgba(255,215,0,0.1), rgba(16,185,129,0.1)); padding: 15px; border-radius: 12px; }
        .prize-analysis { text-align: center; }
        .prize-current { margin-bottom: 15px; }
        .prize-match-count { font-family: 'Orbitron', sans-serif; font-size: 2rem; color: var(--accent-gold); margin-left: 10px; }
        .prize-tier { padding: 10px 20px; border-radius: 10px; font-weight: 700; margin-bottom: 10px; }
        .prize-tier.tier-1 { background: linear-gradient(135deg, #ffd700, #ff9500); color: #1a1a1a; }
        .prize-tier.tier-3 { background: rgba(16,185,129,0.3); color: #34d399; }
        .prize-tier.tier-4 { background: rgba(59,130,246,0.3); color: #60a5fa; }
        .prize-tier.tier-5 { background: rgba(139,92,246,0.3); color: #a78bfa; }
        .matching-balls-detail { margin-top: 15px; display: flex; align-items: center; justify-content: center; gap: 8px; flex-wrap: wrap; }
        
        @media (max-width: 480px) { 
            .container { padding: 10px; } 
            .card { padding: 15px; } 
            .ball { width: 42px; height: 42px; font-size: 0.9rem; } 
            .btn { padding: 12px 20px; font-size: 0.9rem; }
            
            /* ëª¨ë°”ì¼ ì˜ˆì¸¡ ì¹´ë“œ ìŠ¤íƒ€ì¼ */
            .pred-card-header { padding: 12px 15px; flex-direction: column; align-items: flex-start; }
            .pred-card-title { width: 100%; justify-content: flex-start; }
            .pred-card-meta { width: 100%; justify-content: flex-start; margin-top: 8px; }
            .pred-balls-row { padding: 15px 10px; gap: 6px; }
            .pred-balls-row .ball { width: 38px; height: 38px; line-height: 38px; font-size: 0.85rem; }
            .pred-quick-stats { gap: 10px; padding: 12px; }
            .quick-stat { min-width: 50px; }
            .quick-stat-value { font-size: 0.9rem; }
            .pred-detail-section.open { padding: 15px; }
            .pred-toggle-btn { padding: 10px; font-size: 0.85rem; }
            
            /* ìƒì„¸ ë¶„ì„ ëª¨ë°”ì¼ ìŠ¤íƒ€ì¼ */
            .detail-metrics-grid { grid-template-columns: repeat(2, 1fr); gap: 10px; }
            .detail-metric { padding: 10px; }
            .metric-value { font-size: 1.2rem; }
            .dual-analysis { grid-template-columns: 1fr; }
            .dual-ratio { font-size: 1.3rem; }
            .section-bar-detail { flex-wrap: wrap; }
            .section-seg { min-width: 50px; flex: 1 1 auto; }
            .seg-count { font-size: 1rem; }
            .score-bar-header { font-size: 0.8rem; }
            .detail-interpretation { font-size: 0.85rem; padding: 12px; }
            .detail-title { font-size: 0.9rem; }
            .math-item { flex-direction: column; gap: 5px; text-align: left; }
            .gap-stats { flex-direction: column; gap: 5px; }
        }
    </style>
</head>
<body>
    <div class="container">
        <header><h1 class="title">ğŸ° ë¡œë˜ 645 AI ì˜ˆì¸¡ ì‹œìŠ¤í…œ</h1></header>
        <div class="card">
            <div class="card-header"><div class="card-icon gold">ğŸ†</div><h2 class="card-title">ë‹¹ì²¨ë²ˆí˜¸ ì¡°íšŒ</h2></div>
            <div class="input-group">
                <input type="number" id="roundInput" class="input-field" placeholder="íšŒì°¨ ì…ë ¥" min="1">
                <button class="btn btn-primary" onclick="fetchWinningNumbers()">ğŸ” ì¡°íšŒ</button>
            </div>
            <div id="fetchStatus" class="hidden"></div>
            <div id="portalResults" class="hidden"><h4 style="margin:15px 0 10px;color:var(--text-secondary);">ğŸ“¡ í¬í„¸ë³„ ì¡°íšŒ ê²°ê³¼</h4><div id="portalResultsList"></div></div>
            <div class="collapsible" id="manualInputSection">
                <div class="collapsible-header" onclick="toggleCollapsible('manualInputSection')"><span>âœ‹ ìˆ˜ë™ìœ¼ë¡œ ë²ˆí˜¸ ì…ë ¥</span><span class="collapsible-icon">â–¼</span></div>
                <div class="collapsible-content">
                    <p style="color:var(--text-secondary);margin-bottom:15px;">6ê°œì˜ ë²ˆí˜¸ë¥¼ ì„ íƒí•˜ì„¸ìš”</p>
                    <div class="number-grid" id="numberGrid"></div>
                    <div style="text-align:center;margin:15px 0;"><span id="selectedCount">ì„ íƒ: 0ê°œ / 6ê°œ</span></div>
                    <div class="balls-container" id="selectedBalls"></div>
                    <button class="btn btn-gold" onclick="applyManualNumbers()" id="applyBtn" disabled>âœ… ì ìš©</button>
                </div>
            </div>
            <div id="currentWinning" class="hidden">
                <div style="background:linear-gradient(135deg,rgba(255,0,110,0.2),rgba(255,75,43,0.2));padding:20px;border-radius:15px;text-align:center;margin-top:20px;">
                    <h3 style="margin-bottom:10px;">ì œ <span id="winningRound">-</span>íšŒ ë‹¹ì²¨ë²ˆí˜¸</h3>
                    <p style="color:var(--text-secondary);font-size:0.85rem;">ì¶œì²˜: <span id="winningSource">-</span></p>
                </div>
                <div class="balls-container" id="winningBalls"></div>
                
                <!-- ì¢…í•© ì ìˆ˜ ì¹´ë“œ ì¶”ê°€ -->
                <div class="score-card" id="winningScoreCard">
                    <div style="font-size:0.85rem;color:var(--text-secondary);margin-bottom:5px;">ğŸ“Š ë²ˆí˜¸ í’ˆì§ˆ ì¢…í•© ì ìˆ˜</div>
                    <div class="score-main" id="winningScore">-</div>
                    <div class="score-label" id="winningScoreGrade">ë¶„ì„ ì¤‘...</div>
                    <div class="score-breakdown" id="winningScoreBreakdown"></div>
                </div>
                
                <div class="collapsible open" id="winningAnalysis">
                    <div class="collapsible-header" onclick="toggleCollapsible('winningAnalysis')"><span>ğŸ“Š ë‹¹ì²¨ë²ˆí˜¸ ìƒì„¸ ë¶„ì„</span><span class="collapsible-icon">â–¼</span></div>
                    <div class="collapsible-content" id="winningAnalysisContent"></div>
                </div>
            </div>
        </div>
        <div class="card">
            <div class="card-header"><div class="card-icon cyan">ğŸ¤–</div><h2 class="card-title">AI ì˜ˆì¸¡ ë¶„ì„</h2></div>
            <div id="aiNotReady" class="status warning">âš ï¸ ë¨¼ì € ë‹¹ì²¨ë²ˆí˜¸ë¥¼ ì„¤ì •í•´ì£¼ì„¸ìš”!</div>
            <div id="aiReady" class="hidden">
                <div class="status info">ğŸ¯ ì œ <span id="targetRound">-</span>íšŒ ê¸°ì¤€ íŒ¨í„´ ë¶„ì„</div>
                
                <!-- ì‹œë®¬ë ˆì´ì…˜ ì„¤ëª… ì¶”ê°€ -->
                <div class="interpretation-box" style="margin-bottom:20px;">
                    <div class="interpretation-title">ğŸ’¡ AI ë¶„ì„ ì‘ë™ ì›ë¦¬</div>
                    <div class="interpretation-content">
                        ì´ ì‹œìŠ¤í…œì€ <strong>ëª¬í…Œì¹´ë¥¼ë¡œ ì‹œë®¬ë ˆì´ì…˜</strong> ë°©ì‹ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.<br>
                        ë¬´ì‘ìœ„ë¡œ ë¡œë˜ ë²ˆí˜¸ë¥¼ ìƒì„±í•˜ì—¬ ì„¤ì •ëœ ë‹¹ì²¨ë²ˆí˜¸ì™€ ì¼ì¹˜í•˜ëŠ” ì¡°í•©ì„ ì°¾ìœ¼ë©´,<br>
                        ê·¸ <strong>ì§í›„ì— ìƒì„±ë˜ëŠ” ë²ˆí˜¸</strong>ë¥¼ ì˜ˆì¸¡ ë²ˆí˜¸ë¡œ ì œì‹œí•©ë‹ˆë‹¤.<br><br>
                        ğŸ“Œ <strong>ì´ë¡ ì  í™•ë¥ :</strong> ë¡œë˜ 1ë“± í™•ë¥ ì€ ì•½ 1/8,145,060 (0.0000123%)
                    </div>
                </div>
                
                <div class="sim-controls">
                    <label style="color:var(--text-secondary);">ë°˜ë³µ íšŸìˆ˜:</label>
                    <select id="iterationSelect" class="sim-input">
                        <option value="1000000">100ë§ŒíšŒ (ë¹ ë¦„)</option>
                        <option value="10000000">1,000ë§ŒíšŒ (ë³´í†µ)</option>
                        <option value="50000000">5,000ë§ŒíšŒ (ëŠë¦¼)</option>
                        <option value="100000000">1ì–µíšŒ (ì •ë°€)</option>
                        <option value="120000000" selected>1ì–µ 2ì²œë§ŒíšŒ (ë§¤ìš° ì •ë°€)</option>
                    </select>
                    <span class="help-icon">?
                        <div class="tooltip">
                            <div class="tooltip-title">ë°˜ë³µ íšŸìˆ˜ ì•ˆë‚´</div>
                            ë°˜ë³µ íšŸìˆ˜ê°€ ë§ì„ìˆ˜ë¡ ë‹¹ì²¨ë²ˆí˜¸ì™€ ì¼ì¹˜í•˜ëŠ” ì¡°í•©ì„ ì°¾ì„ í™•ë¥ ì´ ë†’ì•„ì§‘ë‹ˆë‹¤.<br><br>
                            â€¢ 100ë§ŒíšŒ: ì•½ 12% í™•ë¥ ë¡œ 1íšŒ ë°œê²¬<br>
                            â€¢ 1000ë§ŒíšŒ: ì•½ 71% í™•ë¥ ë¡œ 1íšŒ ì´ìƒ ë°œê²¬<br>
                            â€¢ 1ì–µíšŒ: ì•½ 12íšŒ ë°œê²¬ ì˜ˆìƒ<br>
                            â€¢ 1ì–µ 2ì²œë§ŒíšŒ: ì•½ 14~15íšŒ ë°œê²¬ ì˜ˆìƒ (ê¶Œì¥)
                        </div>
                    </span>
                </div>
                <button class="btn btn-primary" onclick="startSimulation()" id="startSimBtn" style="width:100%;">ğŸš€ AI ë¶„ì„ ì‹œì‘</button>
                <button class="btn btn-secondary hidden" onclick="stopSimulation()" id="stopSimBtn" style="width:100%;">â¹ï¸ ì¤‘ì§€</button>
            </div>
            <div id="simProgress" class="hidden">
                <div class="progress-container"><div class="progress-bar" id="progressBar" style="width:0%"></div></div>
                <div class="progress-text" id="progressText">ì¤€ë¹„ ì¤‘...</div>
                <div class="stats-row">
                    <div class="stat-item">
                        <span class="help-icon stat-help">?
                            <div class="tooltip">
                                <div class="tooltip-title">ì‹œë„ íšŸìˆ˜</div>
                                í˜„ì¬ê¹Œì§€ ìƒì„±ëœ ë¡œë˜ ë²ˆí˜¸ ì¡°í•©ì˜ ì´ ê°œìˆ˜ì…ë‹ˆë‹¤.
                            </div>
                        </span>
                        <div class="stat-value" id="statAttempts">0</div>
                        <div class="stat-label">ì‹œë„ íšŸìˆ˜</div>
                    </div>
                    <div class="stat-item">
                        <span class="help-icon stat-help">?
                            <div class="tooltip">
                                <div class="tooltip-title">ì²˜ë¦¬ ì†ë„</div>
                                1ì´ˆë‹¹ ìƒì„±ë˜ëŠ” ë¡œë˜ ë²ˆí˜¸ ì¡°í•©ì˜ ê°œìˆ˜ì…ë‹ˆë‹¤. ì»´í“¨í„° ì„±ëŠ¥ì— ë”°ë¼ ë‹¬ë¼ì§‘ë‹ˆë‹¤.
                            </div>
                        </span>
                        <div class="stat-value" id="statSpeed">0</div>
                        <div class="stat-label">íšŒ/ì´ˆ</div>
                    </div>
                    <div class="stat-item">
                        <span class="help-icon stat-help">?
                            <div class="tooltip">
                                <div class="tooltip-title">íŒ¨í„´ ë°œê²¬</div>
                                ë‹¹ì²¨ë²ˆí˜¸ì™€ ì™„ì „íˆ ì¼ì¹˜í•˜ëŠ” ì¡°í•©ì„ ì°¾ì€ íšŸìˆ˜ì…ë‹ˆë‹¤. ì´ ìˆœê°„ ì§í›„ì˜ ë²ˆí˜¸ê°€ ì˜ˆì¸¡ ë²ˆí˜¸ë¡œ ì œì‹œë©ë‹ˆë‹¤.
                            </div>
                        </span>
                        <div class="stat-value" id="statMatches">0</div>
                        <div class="stat-label">ë°œê²¬</div>
                    </div>
                    <div class="stat-item">
                        <span class="help-icon stat-help">?
                            <div class="tooltip">
                                <div class="tooltip-title">ê²½ê³¼ ì‹œê°„</div>
                                ì‹œë®¬ë ˆì´ì…˜ì´ ì‹œì‘ëœ í›„ ê²½ê³¼í•œ ì‹œê°„ì…ë‹ˆë‹¤.
                            </div>
                        </span>
                        <div class="stat-value" id="statTime">0s</div>
                        <div class="stat-label">ê²½ê³¼ ì‹œê°„</div>
                    </div>
                </div>
                
                <!-- ì‹¤ì‹œê°„ í†µê³„ í•´ì„ -->
                <div class="sim-interpretation" id="simInterpretation">
                    <h4>ğŸ“ˆ ì‹¤ì‹œê°„ ë¶„ì„ í•´ì„</h4>
                    <div class="sim-stat-row">
                        <span class="sim-stat-label">ì˜ˆìƒ ë°œê²¬ íšŸìˆ˜</span>
                        <span class="sim-stat-value" id="expectedMatches">-</span>
                    </div>
                    <div class="sim-stat-row">
                        <span class="sim-stat-label">í˜„ì¬ ë°œê²¬ìœ¨</span>
                        <span class="sim-stat-value" id="currentMatchRate">-</span>
                    </div>
                    <div class="sim-stat-row">
                        <span class="sim-stat-label">ì´ë¡ ì  í™•ë¥  ëŒ€ë¹„</span>
                        <span class="sim-stat-value" id="theoreticalComparison">-</span>
                    </div>
                    <div class="sim-stat-note" id="simNote">ì‹œë®¬ë ˆì´ì…˜ì´ ì§„í–‰ë˜ë©´ í†µê³„ê°€ ì—…ë°ì´íŠ¸ë©ë‹ˆë‹¤.</div>
                </div>
            </div>
            <div id="predictionResult" class="hidden">
                <div style="background:linear-gradient(135deg,rgba(17,153,142,0.3),rgba(56,239,125,0.3));padding:20px;border-radius:15px;text-align:center;margin-top:20px;"><h2 style="color:white;">ğŸ± AI ì˜ˆì¸¡ ë²ˆí˜¸</h2></div>
                <div class="balls-container discovery-animation" id="predictionBalls"></div>
                <p id="predictionMeta" style="text-align:center;color:var(--text-secondary);font-size:0.9rem;"></p>
                
                <!-- ì˜ˆì¸¡ ë²ˆí˜¸ í’ˆì§ˆ ì ìˆ˜ -->
                <div class="score-card" id="predictionScoreCard">
                    <div style="font-size:0.85rem;color:var(--text-secondary);margin-bottom:5px;">ğŸ“Š ì˜ˆì¸¡ë²ˆí˜¸ í’ˆì§ˆ ì ìˆ˜</div>
                    <div class="score-main" id="predictionScore">-</div>
                    <div class="score-label" id="predictionScoreGrade">ë¶„ì„ ì¤‘...</div>
                    <div class="score-breakdown" id="predictionScoreBreakdown"></div>
                </div>
                
                <div id="matchingSection" class="hidden">
                    <div class="match-highlight">
                        <div class="match-count" id="matchCount">0</div>
                        <div>ê°œ ë²ˆí˜¸ ì¼ì¹˜!</div>
                        <div class="balls-container" id="matchingBalls"></div>
                        <div id="matchGradeInfo" style="margin-top:15px;font-size:0.9rem;color:var(--text-secondary);"></div>
                    </div>
                </div>
                
                <!-- ë‹¹ì²¨ ë“±ê¸‰ ì •ë³´ -->
                <div class="prize-info">
                    <h4>ğŸ† ë¡œë˜ ë‹¹ì²¨ ë“±ê¸‰ ì•ˆë‚´</h4>
                    <table class="prize-table">
                        <tr><th>ë“±ê¸‰</th><th>ì¡°ê±´</th><th>í™•ë¥ </th></tr>
                        <tr><td class="prize-rank">1ë“±</td><td class="prize-condition">6ê°œ ëª¨ë‘ ì¼ì¹˜</td><td class="prize-prob">1/8,145,060</td></tr>
                        <tr><td class="prize-rank">2ë“±</td><td class="prize-condition">5ê°œ + ë³´ë„ˆìŠ¤</td><td class="prize-prob">1/1,357,510</td></tr>
                        <tr><td class="prize-rank">3ë“±</td><td class="prize-condition">5ê°œ ì¼ì¹˜</td><td class="prize-prob">1/35,724</td></tr>
                        <tr><td class="prize-rank">4ë“±</td><td class="prize-condition">4ê°œ ì¼ì¹˜</td><td class="prize-prob">1/733</td></tr>
                        <tr><td class="prize-rank">5ë“±</td><td class="prize-condition">3ê°œ ì¼ì¹˜</td><td class="prize-prob">1/45</td></tr>
                    </table>
                </div>
                
                <div class="collapsible open" id="predictionAnalysis">
                    <div class="collapsible-header" onclick="toggleCollapsible('predictionAnalysis')"><span>ğŸ“Š ì˜ˆì¸¡ë²ˆí˜¸ ìƒì„¸ ë¶„ì„</span><span class="collapsible-icon">â–¼</span></div>
                    <div class="collapsible-content" id="predictionAnalysisContent"></div>
                </div>
                <div class="collapsible" id="allPredictions">
                    <div class="collapsible-header" onclick="toggleCollapsible('allPredictions')"><span>ğŸ“‹ ë°œê²¬ëœ ëª¨ë“  ì˜ˆì¸¡ ë²ˆí˜¸ (<span id="predictionCount">0</span>ê°œ)</span><span class="collapsible-icon">â–¼</span></div>
                    <div class="collapsible-content"><div class="prediction-list" id="predictionList"></div></div>
                </div>
            </div>
        </div>
        <div class="sponsor-box"><div class="sponsor-title">ğŸ’ ê°œë°œì í›„ì›</div><div class="sponsor-name">ê°•ì¬ì˜</div><div class="sponsor-account">ì‹ í•œì€í–‰ 110-496-114465</div></div>
    </div>
<script>
let currentWinningNumbers = null, currentRound = null, selectedManualNumbers = [], simulationWorker = null, predictions = [], isSimulating = false;
const CORS_PROXIES = ['https://api.allorigins.win/raw?url=', 'https://corsproxy.io/?', 'https://api.codetabs.com/v1/proxy?quest='];
const LOTTO_TOTAL_COMBINATIONS = 8145060;

document.addEventListener('DOMContentLoaded', () => {
    const latestRound = calculateLatestRound();
    document.getElementById('roundInput').value = latestRound;
    document.getElementById('roundInput').max = latestRound;
    createNumberGrid();
    
    // ì´ë²¤íŠ¸ ìœ„ì„ ì„¤ì • - ë™ì ìœ¼ë¡œ ìƒì„±ë˜ëŠ” ìš”ì†Œë“¤ì„ ìœ„í•´
    setupPredictionToggleEvents();
});

function setupPredictionToggleEvents() {
    // í´ë¦­ ì´ë²¤íŠ¸ ìœ„ì„
    document.body.addEventListener('click', handleToggleClick, false);
    
    // í„°ì¹˜ ì´ë²¤íŠ¸ ìœ„ì„ (ëª¨ë°”ì¼ìš©)
    document.body.addEventListener('touchstart', handleTouchStart, {passive: true});
    document.body.addEventListener('touchend', handleTouchEnd, false);
}

let touchStartTarget = null;

function handleTouchStart(e) {
    touchStartTarget = e.target;
}

function handleTouchEnd(e) {
    // í„°ì¹˜ ì‹œì‘ê³¼ ëì´ ê°™ì€ ìš”ì†Œì¸ì§€ í™•ì¸ (ìŠ¤í¬ë¡¤ ë°©ì§€)
    if (touchStartTarget !== e.target) {
        touchStartTarget = null;
        return;
    }

    const toggleBtn = e.target.closest('.pred-toggle-btn');

    if (toggleBtn) {
        e.preventDefault();
        const index = toggleBtn.getAttribute('data-index');
        if (index !== null && index !== undefined) {
            togglePredictionDetail(parseInt(index));
        }
    }
    touchStartTarget = null;
}

function handleToggleClick(e) {
    // í† ê¸€ ë²„íŠ¼ í´ë¦­ ì²˜ë¦¬ë§Œ
    const toggleBtn = e.target.closest('.pred-toggle-btn');
    if (toggleBtn) {
        e.preventDefault();
        e.stopPropagation();
        const index = toggleBtn.getAttribute('data-index');
        if (index !== null && index !== undefined) {
            togglePredictionDetail(parseInt(index));
        }
        return;
    }
}

function calculateLatestRound() {
    const firstDate = new Date(2002, 11, 7), now = new Date();
    return Math.floor((now - firstDate) / (7 * 24 * 60 * 60 * 1000)) + 1;
}

function getBallClass(num) {
    if (num <= 10) return 'yellow';
    if (num <= 20) return 'blue';
    if (num <= 30) return 'red';
    if (num <= 40) return 'gray';
    return 'green';
}

function renderBalls(numbers, containerId, bonus = null) {
    const container = document.getElementById(containerId);
    container.innerHTML = '';
    [...numbers].sort((a, b) => a - b).forEach((num, i) => {
        const ball = document.createElement('span');
        ball.className = `ball ${getBallClass(num)}`;
        ball.textContent = num;
        ball.style.animationDelay = `${i * 0.1}s`;
        container.appendChild(ball);
    });
    if (bonus !== null) {
        const plus = document.createElement('span');
        plus.className = 'plus-sign';
        plus.textContent = '+';
        container.appendChild(plus);
        const bonusBall = document.createElement('span');
        bonusBall.className = 'ball bonus';
        bonusBall.textContent = bonus;
        bonusBall.style.animationDelay = '0.7s';
        container.appendChild(bonusBall);
    }
}

async function fetchWithProxy(url) {
    for (const proxy of CORS_PROXIES) {
        try {
            const response = await fetch(proxy + encodeURIComponent(url), { signal: AbortSignal.timeout(10000) });
            if (response.ok) return await response.text();
        } catch (e) { continue; }
    }
    return null;
}

function extractLottoNumbers(text) {
    const patterns = [/(\d{1,2})\s*[,Â·\s]+\s*(\d{1,2})\s*[,Â·\s]+\s*(\d{1,2})\s*[,Â·\s]+\s*(\d{1,2})\s*[,Â·\s]+\s*(\d{1,2})\s*[,Â·\s]+\s*(\d{1,2})/g];
    for (const pattern of patterns) {
        const matches = [...text.matchAll(pattern)];
        for (const match of matches) {
            const nums = [parseInt(match[1]), parseInt(match[2]), parseInt(match[3]), parseInt(match[4]), parseInt(match[5]), parseInt(match[6])];
            if (nums.every(n => n >= 1 && n <= 45) && new Set(nums).size === 6) return nums.sort((a, b) => a - b);
        }
    }
    return null;
}

async function fetchFromNaver(roundNo) {
    try {
        const html = await fetchWithProxy(`https://search.naver.com/search.naver?where=nexearch&query=${roundNo}íšŒ+ë¡œë˜+ë‹¹ì²¨ë²ˆí˜¸`);
        if (html) return extractLottoNumbers(html);
    } catch (e) {}
    return null;
}

async function fetchFromDaum(roundNo) {
    try {
        const html = await fetchWithProxy(`https://search.daum.net/search?w=tot&q=${roundNo}íšŒ+ë¡œë˜+ë‹¹ì²¨ë²ˆí˜¸`);
        if (html) return extractLottoNumbers(html);
    } catch (e) {}
    return null;
}

async function fetchFromNate(roundNo) {
    try {
        const html = await fetchWithProxy(`https://search.nate.com/search/all.html?q=${roundNo}íšŒ+ë¡œë˜+ë‹¹ì²¨ë²ˆí˜¸`);
        if (html) return extractLottoNumbers(html);
    } catch (e) {}
    return null;
}

async function fetchWinningNumbers() {
    const roundNo = parseInt(document.getElementById('roundInput').value);
    if (!roundNo || roundNo < 1) { showStatus('error', 'ì˜¬ë°”ë¥¸ íšŒì°¨ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.'); return; }
    showStatus('info', 'ğŸ” ë„¤ì´ë²„, ë‹¤ìŒ, ë„¤ì´íŠ¸ì—ì„œ ì¡°íšŒ ì¤‘...');
    document.getElementById('portalResults').classList.add('hidden');

    const results = {}, portalResults = [];
    const [naverNums, daumNums, nateNums] = await Promise.all([fetchFromNaver(roundNo), fetchFromDaum(roundNo), fetchFromNate(roundNo)]);

    if (naverNums) { results['ë„¤ì´ë²„'] = naverNums; portalResults.push({ name: 'ë„¤ì´ë²„', nums: naverNums, success: true }); }
    else { portalResults.push({ name: 'ë„¤ì´ë²„', nums: null, success: false, reason: 'ì¡°íšŒ ì‹¤íŒ¨' }); }
    if (daumNums) { results['ë‹¤ìŒ'] = daumNums; portalResults.push({ name: 'ë‹¤ìŒ', nums: daumNums, success: true }); }
    else { portalResults.push({ name: 'ë‹¤ìŒ', nums: null, success: false, reason: 'ì¡°íšŒ ì‹¤íŒ¨' }); }
    if (nateNums) { results['ë„¤ì´íŠ¸'] = nateNums; portalResults.push({ name: 'ë„¤ì´íŠ¸', nums: nateNums, success: true }); }
    else { portalResults.push({ name: 'ë„¤ì´íŠ¸', nums: null, success: false, reason: 'ì¡°íšŒ ì‹¤íŒ¨' }); }

    showPortalResults(portalResults);

    const successResults = Object.entries(results);
    if (successResults.length >= 2) {
        const numberGroups = {};
        for (const [portal, nums] of successResults) {
            const key = nums.join(',');
            if (!numberGroups[key]) numberGroups[key] = { nums, portals: [] };
            numberGroups[key].portals.push(portal);
        }
        for (const group of Object.values(numberGroups)) {
            if (group.portals.length >= 2) {
                setWinningNumbers(group.nums, roundNo, group.portals.join(', '));
                showStatus('success', `âœ… ì¡°íšŒ ì„±ê³µ! (${group.portals.length}ê°œ í¬í„¸ ì¼ì¹˜: ${group.portals.join(', ')})`);
                return;
            }
        }
        showStatus('warning', `âš ï¸ í¬í„¸ë³„ ê²°ê³¼ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ìˆ˜ë™ìœ¼ë¡œ ì…ë ¥í•´ì£¼ì„¸ìš”.`);
        document.getElementById('manualInputSection').classList.add('open');
    } else if (successResults.length === 1) {
        const [portal, nums] = successResults[0];
        showStatus('warning', `âš ï¸ ${portal}ì—ì„œë§Œ ì¡°íšŒë¨. ê²€ì¦ì„ ìœ„í•´ ìˆ˜ë™ í™•ì¸ì„ ê¶Œì¥í•©ë‹ˆë‹¤.`);
        setWinningNumbers(nums, roundNo, portal + ' (ë‹¨ì¼ ì¶œì²˜)');
    } else {
        showStatus('error', `âŒ ëª¨ë“  í¬í„¸ì—ì„œ ì¡°íšŒ ì‹¤íŒ¨. ìˆ˜ë™ìœ¼ë¡œ ì…ë ¥í•´ì£¼ì„¸ìš”.`);
        document.getElementById('manualInputSection').classList.add('open');
    }
}

function showPortalResults(results) {
    const container = document.getElementById('portalResultsList');
    container.innerHTML = '';
    results.forEach(r => {
        const div = document.createElement('div');
        div.className = 'portal-result';
        div.innerHTML = `<span class="portal-status">${r.success ? 'âœ…' : 'âŒ'}</span><span class="portal-name">${r.name}</span><span style="color:${r.success ? 'var(--accent-cyan)' : 'var(--text-secondary)'}">${r.success ? r.nums.join(', ') : (r.reason || 'ì‹¤íŒ¨')}</span>`;
        container.appendChild(div);
    });
    document.getElementById('portalResults').classList.remove('hidden');
}

function setWinningNumbers(numbers, round, source) {
    currentWinningNumbers = numbers;
    currentRound = round;
    document.getElementById('winningRound').textContent = round;
    document.getElementById('winningSource').textContent = source;
    renderBalls(numbers, 'winningBalls');
    
    const analysis = analyzeNumbers(numbers);
    const score = calculateQualityScore(analysis);
    displayScoreCard('winning', score, analysis);
    document.getElementById('winningAnalysisContent').innerHTML = renderDetailedAnalysis(analysis);
    
    document.getElementById('currentWinning').classList.remove('hidden');
    document.getElementById('aiNotReady').classList.add('hidden');
    document.getElementById('aiReady').classList.remove('hidden');
    document.getElementById('targetRound').textContent = round;
}

function createNumberGrid() {
    const grid = document.getElementById('numberGrid');
    grid.innerHTML = '';
    for (let i = 1; i <= 45; i++) {
        const btn = document.createElement('button');
        btn.className = `number-btn ${getBallClass(i)}`;
        btn.textContent = i;
        btn.onclick = () => toggleNumber(i, btn);
        grid.appendChild(btn);
    }
}

function toggleNumber(num, btn) {
    const idx = selectedManualNumbers.indexOf(num);
    if (idx > -1) { selectedManualNumbers.splice(idx, 1); btn.classList.remove('selected'); }
    else if (selectedManualNumbers.length < 6) { selectedManualNumbers.push(num); btn.classList.add('selected'); }
    updateSelectedDisplay();
}

function updateSelectedDisplay() {
    document.getElementById('selectedCount').textContent = `ì„ íƒ: ${selectedManualNumbers.length}ê°œ / 6ê°œ`;
    if (selectedManualNumbers.length > 0) renderBalls(selectedManualNumbers, 'selectedBalls');
    else document.getElementById('selectedBalls').innerHTML = '';
    document.getElementById('applyBtn').disabled = selectedManualNumbers.length !== 6;
}

function applyManualNumbers() {
    if (selectedManualNumbers.length !== 6) return;
    const round = document.getElementById('roundInput').value || 'ìˆ˜ë™ì…ë ¥';
    setWinningNumbers([...selectedManualNumbers].sort((a, b) => a - b), round, 'ìˆ˜ë™ì…ë ¥');
    showStatus('success', 'âœ… ìˆ˜ë™ ì…ë ¥ ì ìš© ì™„ë£Œ!');
    document.getElementById('manualInputSection').classList.remove('open');
}

function analyzeNumbers(nums) {
    const sorted = [...nums].sort((a, b) => a - b);
    const diffs = new Set();
    for (let i = 0; i < sorted.length; i++) for (let j = i + 1; j < sorted.length; j++) diffs.add(sorted[j] - sorted[i]);
    const ac = diffs.size - 5;
    const odd = sorted.filter(n => n % 2 === 1), even = sorted.filter(n => n % 2 === 0);
    const low = sorted.filter(n => n <= 22), high = sorted.filter(n => n > 22);
    const sections = { 
        '1-10': sorted.filter(n => n >= 1 && n <= 10), 
        '11-20': sorted.filter(n => n >= 11 && n <= 20), 
        '21-30': sorted.filter(n => n >= 21 && n <= 30), 
        '31-40': sorted.filter(n => n >= 31 && n <= 40), 
        '41-45': sorted.filter(n => n >= 41 && n <= 45) 
    };
    const consecutiveGroups = [];
    let tempGroup = [sorted[0]];
    for (let i = 0; i < sorted.length - 1; i++) {
        if (sorted[i + 1] - sorted[i] === 1) tempGroup.push(sorted[i + 1]);
        else { if (tempGroup.length > 1) consecutiveGroups.push([...tempGroup]); tempGroup = [sorted[i + 1]]; }
    }
    if (tempGroup.length > 1) consecutiveGroups.push(tempGroup);
    const gaps = []; for (let i = 0; i < sorted.length - 1; i++) gaps.push(sorted[i + 1] - sorted[i]);
    const isPrime = n => { if (n < 2) return false; for (let i = 2; i <= Math.sqrt(n); i++) if (n % i === 0) return false; return true; };
    const primes = sorted.filter(isPrime), mult3 = sorted.filter(n => n % 3 === 0), mult5 = sorted.filter(n => n % 5 === 0);
    const sum = sorted.reduce((a, b) => a + b, 0);
    const sectionsWithNumbers = Object.values(sections).filter(s => s.length > 0).length;
    
    return { 
        numbers: sorted, sum, avg: (sum / 6).toFixed(1), ac, 
        odd, even, oddCount: odd.length, evenCount: even.length, oddEvenRatio: `${odd.length}:${even.length}`, 
        low, high, lowCount: low.length, highCount: high.length, lowHighRatio: `${low.length}:${high.length}`, 
        sections, sectionsWithNumbers, consecutiveGroups, 
        gaps, minGap: Math.min(...gaps), maxGap: Math.max(...gaps), avgGap: (gaps.reduce((a, b) => a + b, 0) / gaps.length).toFixed(1), 
        primes, mult3, mult5, 
        uniqueLastDigits: new Set(sorted.map(n => n % 10)).size, 
        range: sorted[5] - sorted[0] 
    };
}

// í’ˆì§ˆ ì ìˆ˜ ê³„ì‚° í•¨ìˆ˜
function calculateQualityScore(a) {
    let totalScore = 0;
    let breakdown = {};
    
    // 1. í•©ê³„ ì ìˆ˜ (0-25ì )
    let sumScore = 0;
    if (a.sum >= 115 && a.sum <= 150) sumScore = 25;
    else if (a.sum >= 100 && a.sum <= 175) sumScore = 20;
    else if (a.sum >= 80 && a.sum <= 200) sumScore = 10;
    else sumScore = 5;
    breakdown.sum = { score: sumScore, max: 25, label: 'í•©ê³„' };
    totalScore += sumScore;
    
    // 2. ACê°’ ì ìˆ˜ (0-20ì )
    let acScore = 0;
    if (a.ac >= 7 && a.ac <= 10) acScore = 20;
    else if (a.ac >= 5 && a.ac <= 6) acScore = 15;
    else if (a.ac >= 4) acScore = 10;
    else acScore = 5;
    breakdown.ac = { score: acScore, max: 20, label: 'ACê°’' };
    totalScore += acScore;
    
    // 3. í™€ì§ ë¹„ìœ¨ ì ìˆ˜ (0-20ì )
    let oddEvenScore = 0;
    const oddEvenDiff = Math.abs(a.oddCount - a.evenCount);
    if (oddEvenDiff <= 2) oddEvenScore = 20;
    else if (oddEvenDiff <= 4) oddEvenScore = 10;
    else oddEvenScore = 5;
    breakdown.oddEven = { score: oddEvenScore, max: 20, label: 'í™€ì§' };
    totalScore += oddEvenScore;
    
    // 4. ê³ ì € ë¹„ìœ¨ ì ìˆ˜ (0-15ì )
    let lowHighScore = 0;
    const lowHighDiff = Math.abs(a.lowCount - a.highCount);
    if (lowHighDiff <= 2) lowHighScore = 15;
    else if (lowHighDiff <= 4) lowHighScore = 10;
    else lowHighScore = 5;
    breakdown.lowHigh = { score: lowHighScore, max: 15, label: 'ê³ ì €' };
    totalScore += lowHighScore;
    
    // 5. êµ¬ê°„ ë¶„í¬ ì ìˆ˜ (0-20ì )
    let sectionScore = 0;
    if (a.sectionsWithNumbers >= 4) sectionScore = 20;
    else if (a.sectionsWithNumbers === 3) sectionScore = 15;
    else if (a.sectionsWithNumbers === 2) sectionScore = 10;
    else sectionScore = 5;
    breakdown.section = { score: sectionScore, max: 20, label: 'ë¶„í¬' };
    totalScore += sectionScore;
    
    const grade = totalScore >= 90 ? 'ìµœìƒ' : totalScore >= 75 ? 'ì–‘í˜¸' : totalScore >= 60 ? 'ë³´í†µ' : totalScore >= 45 ? 'ì£¼ì˜' : 'ë¯¸í¡';
    const gradeClass = totalScore >= 90 ? 'excellent' : totalScore >= 75 ? 'good' : totalScore >= 60 ? 'normal' : totalScore >= 45 ? 'caution' : 'bad';
    
    return { totalScore, breakdown, grade, gradeClass };
}

// ì ìˆ˜ ì¹´ë“œ í‘œì‹œ
function displayScoreCard(prefix, scoreData, analysis) {
    document.getElementById(`${prefix}Score`).textContent = scoreData.totalScore;
    document.getElementById(`${prefix}ScoreGrade`).textContent = `ë“±ê¸‰: ${scoreData.grade} (ìƒìœ„ ${getPercentile(scoreData.totalScore)}%)`;
    
    const breakdownHtml = Object.values(scoreData.breakdown).map(item => `
        <div class="score-item">
            <div class="score-item-value" style="color: ${item.score >= item.max * 0.8 ? 'var(--grade-excellent)' : item.score >= item.max * 0.6 ? 'var(--grade-good)' : 'var(--grade-caution)'}">
                ${item.score}/${item.max}
            </div>
            <div class="score-item-label">${item.label}</div>
        </div>
    `).join('');
    document.getElementById(`${prefix}ScoreBreakdown`).innerHTML = breakdownHtml;
}

function getPercentile(score) {
    if (score >= 90) return '10';
    if (score >= 80) return '25';
    if (score >= 70) return '40';
    if (score >= 60) return '55';
    if (score >= 50) return '70';
    return '85';
}

// ìƒì„¸ ë¶„ì„ ë Œë”ë§ (ê°œì„ ëœ ë²„ì „)
function renderDetailedAnalysis(a) {
    const getGrade = (value, optimal, good, normal) => {
        if (value >= optimal[0] && value <= optimal[1]) return { grade: 'excellent', text: 'ìµœì ', badge: 'badge-excellent' };
        if (value >= good[0] && value <= good[1]) return { grade: 'good', text: 'ì–‘í˜¸', badge: 'badge-good' };
        if (value >= normal[0] && value <= normal[1]) return { grade: 'normal', text: 'ë³´í†µ', badge: 'badge-normal' };
        return { grade: 'caution', text: 'ì£¼ì˜', badge: 'badge-caution' };
    };
    
    const sumGrade = getGrade(a.sum, [115, 150], [100, 175], [80, 200]);
    const acGrade = getGrade(a.ac, [7, 10], [5, 6], [4, 4]);
    const oddEvenDiff = Math.abs(a.oddCount - a.evenCount);
    const oddEvenGrade = getGrade(6 - oddEvenDiff, [4, 6], [2, 3], [1, 1]);
    const lowHighDiff = Math.abs(a.lowCount - a.highCount);
    const lowHighGrade = getGrade(6 - lowHighDiff, [4, 6], [2, 3], [1, 1]);
    
    return `
        <!-- ì¢…í•© í•´ì„ -->
        <div class="interpretation-box">
            <div class="interpretation-title">ğŸ“‹ ì¢…í•© í•´ì„</div>
            <div class="interpretation-content">
                ì´ ë²ˆí˜¸ ì¡°í•©ì€ <strong>í•©ê³„ ${a.sum}</strong>ìœ¼ë¡œ ${sumGrade.text} ë²”ìœ„ì— ìˆìŠµë‹ˆë‹¤.
                í™€ì§ ë¹„ìœ¨ <strong>${a.oddEvenRatio}</strong>, ê³ ì € ë¹„ìœ¨ <strong>${a.lowHighRatio}</strong>ìœ¼ë¡œ 
                ${oddEvenDiff <= 2 && lowHighDiff <= 2 ? 'ë§¤ìš° ê· í˜•ì¡íŒ' : oddEvenDiff <= 4 && lowHighDiff <= 4 ? 'ì ì ˆíˆ ë¶„ì‚°ëœ' : 'ë‹¤ì†Œ í¸ì¤‘ëœ'} êµ¬ì„±ì…ë‹ˆë‹¤.
                <strong>${a.sectionsWithNumbers}ê°œ êµ¬ê°„</strong>ì— ë¶„í¬í•˜ë©°, 
                ${a.consecutiveGroups.length > 0 ? `ì—°ì†ë²ˆí˜¸ ${a.consecutiveGroups.length}ê·¸ë£¹ì´ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤.` : 'ì—°ì†ë²ˆí˜¸ëŠ” ì—†ìŠµë‹ˆë‹¤.'}
            </div>
        </div>
        
        <div class="analysis-grid">
            <!-- í•©ê³„ -->
            <div class="analysis-item grade-${sumGrade.grade}">
                <div class="analysis-header">
                    <div class="analysis-label">
                        í•©ê³„
                        <span class="help-icon">?
                            <div class="tooltip">
                                <div class="tooltip-title">í•©ê³„ë€?</div>
                                6ê°œ ë²ˆí˜¸ë¥¼ ëª¨ë‘ ë”í•œ ê°’ì…ë‹ˆë‹¤.<br><br>
                                <strong>ê¶Œì¥ ë²”ìœ„:</strong> 115~150<br>
                                <strong>í†µê³„:</strong> ì—­ëŒ€ ë‹¹ì²¨ë²ˆí˜¸ì˜ ì•½ 65%ê°€ ì´ ë²”ìœ„ ë‚´
                            </div>
                        </span>
                    </div>
                    <span class="analysis-badge ${sumGrade.badge}">${sumGrade.text}</span>
                </div>
                <div class="analysis-value">${a.sum}</div>
                <div class="analysis-detail">
                    ê¶Œì¥: 115~150 | í‰ê· : ${a.avg}<br>
                    ${a.sum < 100 ? 'âš ï¸ ë‚®ì€ ë²ˆí˜¸ì— ì¹˜ìš°ì¹¨' : a.sum > 180 ? 'âš ï¸ ë†’ì€ ë²ˆí˜¸ì— ì¹˜ìš°ì¹¨' : 'âœ“ ì ì • ë²”ìœ„'}
                </div>
            </div>
            
            <!-- ACê°’ -->
            <div class="analysis-item grade-${acGrade.grade}">
                <div class="analysis-header">
                    <div class="analysis-label">
                        ACê°’
                        <span class="help-icon">?
                            <div class="tooltip">
                                <div class="tooltip-title">ACê°’ (Arithmetic Complexity)</div>
                                ë²ˆí˜¸ë“¤ ê°„ì˜ ì°¨ì´ê°’ ë‹¤ì–‘ì„±ì„ ë‚˜íƒ€ë‚´ëŠ” ì§€í‘œì…ë‹ˆë‹¤.<br><br>
                                <strong>ê³„ì‚°:</strong> (ë²ˆí˜¸ìŒ ì°¨ì´ ì¢…ë¥˜ ìˆ˜) - 5<br>
                                <strong>ë²”ìœ„:</strong> 0~10<br>
                                <strong>ê¶Œì¥:</strong> 7~10 (ë³µì¡í• ìˆ˜ë¡ ì¢‹ìŒ)
                            </div>
                        </span>
                    </div>
                    <span class="analysis-badge ${acGrade.badge}">${acGrade.text}</span>
                </div>
                <div class="analysis-value">${a.ac}</div>
                <div class="analysis-detail">
                    ê¶Œì¥: 7~10 | ìµœëŒ€: 10<br>
                    ${a.ac >= 7 ? 'âœ“ ë²ˆí˜¸ êµ¬ì„±ì´ ë‹¤ì–‘í•¨' : a.ac >= 5 ? 'â—‹ ì ë‹¹í•œ ë‹¤ì–‘ì„±' : 'âš ï¸ ë²ˆí˜¸ê°€ ë‹¨ì¡°ë¡œì›€'}
                </div>
            </div>
            
            <!-- ë²ˆí˜¸ ë²”ìœ„ -->
            <div class="analysis-item">
                <div class="analysis-header">
                    <div class="analysis-label">
                        ë²ˆí˜¸ ë²”ìœ„
                        <span class="help-icon">?
                            <div class="tooltip">
                                <div class="tooltip-title">ë²ˆí˜¸ ë²”ìœ„</div>
                                ê°€ì¥ í° ë²ˆí˜¸ì™€ ê°€ì¥ ì‘ì€ ë²ˆí˜¸ì˜ ì°¨ì´ì…ë‹ˆë‹¤.<br><br>
                                <strong>ìµœì†Œ ë²ˆí˜¸:</strong> ${a.numbers[0]}<br>
                                <strong>ìµœëŒ€ ë²ˆí˜¸:</strong> ${a.numbers[5]}<br>
                                <strong>ê¶Œì¥:</strong> 25 ì´ìƒì´ë©´ ë„“ê²Œ ë¶„í¬
                            </div>
                        </span>
                    </div>
                </div>
                <div class="analysis-value">${a.range}</div>
                <div class="analysis-detail">
                    ${a.numbers[0]} ~ ${a.numbers[5]}<br>
                    ${a.range >= 30 ? 'âœ“ ë„“ì€ ë¶„í¬' : a.range >= 20 ? 'â—‹ ì ë‹¹í•œ ë¶„í¬' : 'âš ï¸ ì¢ì€ ë¶„í¬'}
                </div>
            </div>
            
            <!-- ëìë¦¬ -->
            <div class="analysis-item">
                <div class="analysis-header">
                    <div class="analysis-label">
                        ëìë¦¬ ì¢…ë¥˜
                        <span class="help-icon">?
                            <div class="tooltip">
                                <div class="tooltip-title">ëìë¦¬ ì¢…ë¥˜</div>
                                6ê°œ ë²ˆí˜¸ì˜ ëìë¦¬(ì¼ì˜ ìë¦¬)ê°€ ëª‡ ê°€ì§€ì¸ì§€ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.<br><br>
                                <strong>ì˜ˆ:</strong> 3, 13, 23ì€ ëª¨ë‘ ëìë¦¬ê°€ 3<br>
                                <strong>ê¶Œì¥:</strong> 4ê°œ ì´ìƒì´ë©´ ë‹¤ì–‘í•¨
                            </div>
                        </span>
                    </div>
                </div>
                <div class="analysis-value">${a.uniqueLastDigits}ê°œ</div>
                <div class="analysis-detail">
                    ìµœëŒ€ 6ê°œ ê°€ëŠ¥<br>
                    ${a.uniqueLastDigits >= 5 ? 'âœ“ ë§¤ìš° ë‹¤ì–‘í•¨' : a.uniqueLastDigits >= 4 ? 'â—‹ ì ë‹¹í•¨' : 'âš ï¸ ì¤‘ë³µ ë§ìŒ'}
                </div>
            </div>
        </div>
        
        <!-- í™€ì§ ë¶„ì„ -->
        <div style="margin-top:25px;">
            <h4 style="color:var(--accent-cyan);margin-bottom:15px;display:flex;align-items:center;gap:8px;">
                ğŸ² í™€ì§ ë¶„ì„
                <span class="analysis-badge ${oddEvenGrade.badge}">${oddEvenGrade.text}</span>
            </h4>
            <div style="display:flex;gap:20px;flex-wrap:wrap;">
                <div style="flex:1;min-width:200px;background:rgba(0,0,0,0.2);padding:15px;border-radius:10px;">
                    <div style="font-size:0.85rem;color:var(--text-secondary);margin-bottom:8px;">ë¹„ìœ¨</div>
                    <div style="font-family:'Orbitron';font-size:1.5rem;color:var(--accent-gold);">${a.oddEvenRatio}</div>
                    <div style="font-size:0.8rem;color:var(--text-secondary);margin-top:5px;">í™€ìˆ˜ : ì§ìˆ˜</div>
                </div>
                <div style="flex:2;min-width:200px;">
                    <div style="margin-bottom:10px;">
                        <span style="color:var(--accent-pink);">í™€ìˆ˜ (${a.oddCount}ê°œ):</span>
                        <span style="color:var(--text-secondary);margin-left:10px;">${a.odd.join(', ') || 'ì—†ìŒ'}</span>
                    </div>
                    <div>
                        <span style="color:var(--accent-cyan);">ì§ìˆ˜ (${a.evenCount}ê°œ):</span>
                        <span style="color:var(--text-secondary);margin-left:10px;">${a.even.join(', ') || 'ì—†ìŒ'}</span>
                    </div>
                    <div style="margin-top:10px;padding:10px;background:rgba(0,0,0,0.2);border-radius:8px;font-size:0.85rem;">
                        ğŸ’¡ <strong>í†µê³„:</strong> 3:3 ë¹„ìœ¨ì´ ê°€ì¥ ë§ì´ ì¶œí˜„ (ì•½ 33%), 4:2 ë˜ëŠ” 2:4ê°€ ê·¸ ë‹¤ìŒ (ì•½ 26%)
                    </div>
                </div>
            </div>
        </div>
        
        <!-- ê³ ì € ë¶„ì„ -->
        <div style="margin-top:25px;">
            <h4 style="color:var(--accent-cyan);margin-bottom:15px;display:flex;align-items:center;gap:8px;">
                ğŸ“ˆ ê³ ì € ë¶„ì„
                <span class="analysis-badge ${lowHighGrade.badge}">${lowHighGrade.text}</span>
            </h4>
            <div style="display:flex;gap:20px;flex-wrap:wrap;">
                <div style="flex:1;min-width:200px;background:rgba(0,0,0,0.2);padding:15px;border-radius:10px;">
                    <div style="font-size:0.85rem;color:var(--text-secondary);margin-bottom:8px;">ë¹„ìœ¨</div>
                    <div style="font-family:'Orbitron';font-size:1.5rem;color:var(--accent-gold);">${a.lowHighRatio}</div>
                    <div style="font-size:0.8rem;color:var(--text-secondary);margin-top:5px;">ì €ë²ˆí˜¸ : ê³ ë²ˆí˜¸</div>
                </div>
                <div style="flex:2;min-width:200px;">
                    <div style="margin-bottom:10px;">
                        <span style="color:#60a5fa;">ì €ë²ˆí˜¸ 1~22 (${a.lowCount}ê°œ):</span>
                        <span style="color:var(--text-secondary);margin-left:10px;">${a.low.join(', ') || 'ì—†ìŒ'}</span>
                    </div>
                    <div>
                        <span style="color:#f87171;">ê³ ë²ˆí˜¸ 23~45 (${a.highCount}ê°œ):</span>
                        <span style="color:var(--text-secondary);margin-left:10px;">${a.high.join(', ') || 'ì—†ìŒ'}</span>
                    </div>
                    <div style="margin-top:10px;padding:10px;background:rgba(0,0,0,0.2);border-radius:8px;font-size:0.85rem;">
                        ğŸ’¡ <strong>í†µê³„:</strong> 3:3 ë¹„ìœ¨ì´ ê°€ì¥ ë§ì´ ì¶œí˜„ (ì•½ 33%), 4:2 ë˜ëŠ” 2:4ê°€ ê·¸ ë‹¤ìŒ (ì•½ 26%)
                    </div>
                </div>
            </div>
        </div>
        
        <!-- êµ¬ê°„ë³„ ë¶„í¬ -->
        <div style="margin-top:25px;">
            <h4 style="color:var(--accent-cyan);margin-bottom:15px;">ğŸ“ êµ¬ê°„ë³„ ë¶„í¬ (${a.sectionsWithNumbers}ê°œ êµ¬ê°„ ì‚¬ìš©)</h4>
            <div class="section-bar">
                <div class="section-segment s1 ${a.sections['1-10'].length > 0 ? 'active' : ''}">
                    <span>${a.sections['1-10'].length}</span>
                </div>
                <div class="section-segment s2 ${a.sections['11-20'].length > 0 ? 'active' : ''}">
                    <span>${a.sections['11-20'].length}</span>
                </div>
                <div class="section-segment s3 ${a.sections['21-30'].length > 0 ? 'active' : ''}">
                    <span>${a.sections['21-30'].length}</span>
                </div>
                <div class="section-segment s4 ${a.sections['31-40'].length > 0 ? 'active' : ''}">
                    <span>${a.sections['31-40'].length}</span>
                </div>
                <div class="section-segment s5 ${a.sections['41-45'].length > 0 ? 'active' : ''}">
                    <span>${a.sections['41-45'].length}</span>
                </div>
            </div>
            <div style="display:flex;justify-content:space-between;font-size:0.75rem;color:var(--text-secondary);margin-top:8px;">
                <span>1-10</span><span>11-20</span><span>21-30</span><span>31-40</span><span>41-45</span>
            </div>
            <div style="margin-top:15px;display:grid;grid-template-columns:repeat(auto-fit, minmax(150px, 1fr));gap:10px;">
                ${Object.entries(a.sections).map(([range, nums]) => `
                    <div style="background:rgba(0,0,0,0.2);padding:10px;border-radius:8px;text-align:center;">
                        <div style="font-size:0.75rem;color:var(--text-secondary);">${range}</div>
                        <div style="color:${nums.length > 0 ? 'var(--accent-cyan)' : 'var(--text-secondary)'};margin-top:5px;">
                            ${nums.length > 0 ? nums.join(', ') : '-'}
                        </div>
                    </div>
                `).join('')}
            </div>
            <div style="margin-top:10px;padding:10px;background:rgba(0,0,0,0.2);border-radius:8px;font-size:0.85rem;">
                ğŸ’¡ <strong>ê¶Œì¥:</strong> 4ê°œ ì´ìƒì˜ êµ¬ê°„ì— ë¶„í¬ë˜ì–´ ìˆìœ¼ë©´ ê· í˜•ì  (í˜„ì¬ ${a.sectionsWithNumbers}ê°œ êµ¬ê°„)
            </div>
        </div>
        
        <!-- ì—°ì†ë²ˆí˜¸ -->
        <div style="margin-top:25px;">
            <h4 style="color:var(--accent-cyan);margin-bottom:15px;">ğŸ”— ì—°ì†ë²ˆí˜¸ ë¶„ì„</h4>
            <div style="background:rgba(0,0,0,0.2);padding:15px;border-radius:10px;">
                ${a.consecutiveGroups.length > 0 ? `
                    <div style="margin-bottom:10px;">
                        <span style="color:var(--accent-gold);">${a.consecutiveGroups.length}ê°œ ê·¸ë£¹</span> ë°œê²¬
                    </div>
                    <div style="display:flex;gap:10px;flex-wrap:wrap;">
                        ${a.consecutiveGroups.map(g => `
                            <div style="background:rgba(139,92,246,0.2);padding:8px 15px;border-radius:20px;border:1px solid rgba(139,92,246,0.5);">
                                ${g.join(' â†’ ')}
                            </div>
                        `).join('')}
                    </div>
                ` : `
                    <div style="color:var(--text-secondary);">ì—°ì†ë²ˆí˜¸ ì—†ìŒ</div>
                `}
                <div style="margin-top:15px;font-size:0.85rem;color:var(--text-secondary);">
                    ğŸ’¡ <strong>í†µê³„:</strong> ì—­ëŒ€ ë‹¹ì²¨ë²ˆí˜¸ì˜ ì•½ 60%ê°€ ì—°ì†ë²ˆí˜¸ 1ê°œ ì´ìƒ í¬í•¨
                </div>
            </div>
        </div>
        
        <!-- ê°„ê²© ë¶„ì„ -->
        <div style="margin-top:25px;">
            <h4 style="color:var(--accent-cyan);margin-bottom:15px;">ğŸ“ ë²ˆí˜¸ ê°„ê²© ë¶„ì„</h4>
            <div style="background:rgba(0,0,0,0.2);padding:15px;border-radius:10px;">
                <div style="display:flex;gap:15px;flex-wrap:wrap;margin-bottom:15px;">
                    <div style="text-align:center;">
                        <div style="font-size:0.75rem;color:var(--text-secondary);">ìµœì†Œ ê°„ê²©</div>
                        <div style="font-family:'Orbitron';font-size:1.3rem;color:${a.minGap === 1 ? 'var(--accent-pink)' : 'var(--accent-cyan)'}">${a.minGap}</div>
                    </div>
                    <div style="text-align:center;">
                        <div style="font-size:0.75rem;color:var(--text-secondary);">ìµœëŒ€ ê°„ê²©</div>
                        <div style="font-family:'Orbitron';font-size:1.3rem;color:var(--accent-cyan)">${a.maxGap}</div>
                    </div>
                    <div style="text-align:center;">
                        <div style="font-size:0.75rem;color:var(--text-secondary);">í‰ê·  ê°„ê²©</div>
                        <div style="font-family:'Orbitron';font-size:1.3rem;color:var(--accent-cyan)">${a.avgGap}</div>
                    </div>
                </div>
                <div style="font-size:0.9rem;color:var(--text-secondary);">
                    ê°„ê²© ìˆœì„œ: <span style="color:var(--text-primary)">${a.gaps.join(' â†’ ')}</span>
                </div>
                <div style="margin-top:10px;font-size:0.85rem;color:var(--text-secondary);">
                    ğŸ’¡ í‰ê·  ê°„ê²© ${a.avgGap}ì€(ëŠ”) ${parseFloat(a.avgGap) >= 5 && parseFloat(a.avgGap) <= 9 ? 'ì ì • ë²”ìœ„ì…ë‹ˆë‹¤.' : 'ë‹¤ì†Œ ' + (parseFloat(a.avgGap) < 5 ? 'ì¢ìŠµë‹ˆë‹¤.' : 'ë„“ìŠµë‹ˆë‹¤.')}
                </div>
            </div>
        </div>
        
        <!-- ìˆ˜í•™ì  íŠ¹ì„± -->
        <div style="margin-top:25px;">
            <h4 style="color:var(--accent-cyan);margin-bottom:15px;">ğŸ”¬ ìˆ˜í•™ì  íŠ¹ì„±</h4>
            <div style="display:grid;grid-template-columns:repeat(auto-fit, minmax(200px, 1fr));gap:15px;">
                <div style="background:rgba(0,0,0,0.2);padding:15px;border-radius:10px;">
                    <div style="font-size:0.85rem;color:var(--text-secondary);margin-bottom:8px;">ì†Œìˆ˜ (Prime)</div>
                    <div style="color:var(--accent-cyan);">${a.primes.length > 0 ? a.primes.join(', ') : 'ì—†ìŒ'}</div>
                    <div style="font-size:0.75rem;color:var(--text-secondary);margin-top:5px;">${a.primes.length}ê°œ / 1~45 ì¤‘ ì†Œìˆ˜: 2,3,5,7,11,13,17,19,23,29,31,37,41,43</div>
                </div>
                <div style="background:rgba(0,0,0,0.2);padding:15px;border-radius:10px;">
                    <div style="font-size:0.85rem;color:var(--text-secondary);margin-bottom:8px;">3ì˜ ë°°ìˆ˜</div>
                    <div style="color:var(--accent-cyan);">${a.mult3.length > 0 ? a.mult3.join(', ') : 'ì—†ìŒ'}</div>
                    <div style="font-size:0.75rem;color:var(--text-secondary);margin-top:5px;">${a.mult3.length}ê°œ</div>
                </div>
                <div style="background:rgba(0,0,0,0.2);padding:15px;border-radius:10px;">
                    <div style="font-size:0.85rem;color:var(--text-secondary);margin-bottom:8px;">5ì˜ ë°°ìˆ˜</div>
                    <div style="color:var(--accent-cyan);">${a.mult5.length > 0 ? a.mult5.join(', ') : 'ì—†ìŒ'}</div>
                    <div style="font-size:0.75rem;color:var(--text-secondary);margin-top:5px;">${a.mult5.length}ê°œ</div>
                </div>
            </div>
        </div>
    `;
}

function startSimulation() {
    if (!currentWinningNumbers) { alert('ë¨¼ì € ë‹¹ì²¨ë²ˆí˜¸ë¥¼ ì„¤ì •í•´ì£¼ì„¸ìš”!'); return; }
    const maxIterations = parseInt(document.getElementById('iterationSelect').value);
    document.getElementById('startSimBtn').classList.add('hidden');
    document.getElementById('stopSimBtn').classList.remove('hidden');
    document.getElementById('simProgress').classList.remove('hidden');
    document.getElementById('predictionResult').classList.add('hidden');
    predictions = []; isSimulating = true;
    
    // ì˜ˆìƒ ë°œê²¬ íšŸìˆ˜ ê³„ì‚°
    const expectedMatches = (maxIterations / LOTTO_TOTAL_COMBINATIONS).toFixed(1);
    document.getElementById('expectedMatches').textContent = `ì•½ ${expectedMatches}íšŒ`;
    document.getElementById('simNote').textContent = `${formatNumber(maxIterations)}íšŒ ì‹œë®¬ë ˆì´ì…˜ ì¤‘ ì•½ ${expectedMatches}íšŒ íŒ¨í„´ ë°œê²¬ ì˜ˆìƒ`;
    
    const workerCode = `self.onmessage = function(e) { const { targetNums, maxIterations } = e.data; const targetStr = targetNums.sort((a,b) => a-b).join(','); let attempts = 0, matchCount = 0; const predictions = [], startTime = Date.now(), POOL = Array.from({length: 45}, (_, i) => i + 1); function generateNumbers() { const nums = [], pool = [...POOL]; for (let i = 0; i < 6; i++) { const idx = Math.floor(Math.random() * pool.length); nums.push(pool.splice(idx, 1)[0]); } return nums.sort((a, b) => a - b); } function runBatch() { const batchSize = 100000, batchEnd = Math.min(attempts + batchSize, maxIterations); while (attempts < batchEnd) { const current = generateNumbers(); attempts++; if (current.join(',') === targetStr) { matchCount++; const nextNums = generateNumbers(), elapsed = (Date.now() - startTime) / 1000; predictions.push({ matchNum: matchCount, attempt: attempts, time: elapsed, prediction: nextNums }); self.postMessage({ type: 'match', data: { matchCount, attempts, elapsed, prediction: nextNums } }); } } const elapsed = (Date.now() - startTime) / 1000, speed = Math.round(attempts / elapsed), progress = attempts / maxIterations; self.postMessage({ type: 'progress', data: { attempts, progress, speed, elapsed, matchCount } }); if (attempts < maxIterations) setTimeout(runBatch, 0); else self.postMessage({ type: 'complete', data: { attempts, matchCount, elapsed, predictions } }); } runBatch(); };`;
    const blob = new Blob([workerCode], { type: 'application/javascript' });
    simulationWorker = new Worker(URL.createObjectURL(blob));
    simulationWorker.onmessage = function(e) { const { type, data } = e.data; if (type === 'progress') updateProgress(data); else if (type === 'match') handleMatch(data); else if (type === 'complete') handleComplete(data); };
    simulationWorker.postMessage({ targetNums: currentWinningNumbers, maxIterations });
}

function stopSimulation() {
    if (simulationWorker) { simulationWorker.terminate(); simulationWorker = null; }
    isSimulating = false;
    document.getElementById('startSimBtn').classList.remove('hidden');
    document.getElementById('stopSimBtn').classList.add('hidden');
    showStatus('warning', 'â¹ï¸ ì‹œë®¬ë ˆì´ì…˜ì´ ì¤‘ì§€ë˜ì—ˆìŠµë‹ˆë‹¤.');
}

function updateProgress(data) {
    const { attempts, progress, speed, elapsed, matchCount } = data;
    document.getElementById('progressBar').style.width = `${progress * 100}%`;
    document.getElementById('progressText').textContent = `${(progress * 100).toFixed(1)}% ì™„ë£Œ (${formatNumber(attempts)}íšŒ)`;
    document.getElementById('statAttempts').textContent = formatNumber(attempts);
    document.getElementById('statSpeed').textContent = formatNumber(speed);
    document.getElementById('statMatches').textContent = matchCount;
    document.getElementById('statTime').textContent = `${elapsed.toFixed(1)}s`;
    
    // ì‹¤ì‹œê°„ í†µê³„ ì—…ë°ì´íŠ¸
    const currentRate = attempts > 0 ? (matchCount / attempts * LOTTO_TOTAL_COMBINATIONS).toFixed(2) : '0';
    document.getElementById('currentMatchRate').textContent = matchCount > 0 ? `${formatNumber(Math.round(attempts / matchCount))}íšŒë‹¹ 1íšŒ` : 'ì•„ì§ ë¯¸ë°œê²¬';
    document.getElementById('theoreticalComparison').textContent = matchCount > 0 ? 
        (parseFloat(currentRate) > 0.8 && parseFloat(currentRate) < 1.2 ? 'ì •ìƒ ë²”ìœ„' : parseFloat(currentRate) >= 1.2 ? 'í–‰ìš´!' : 'ì¡°ê¸ˆ ë‚®ìŒ') : '-';
}

function handleMatch(data) {
    const { matchCount, attempts, elapsed, prediction } = data;
    predictions.push({ matchNum: matchCount, attempt: attempts, time: elapsed, prediction });
    if (matchCount === 1) showPredictionResult(prediction, attempts, elapsed);
    updatePredictionList();
}

function handleComplete(data) {
    isSimulating = false;
    document.getElementById('startSimBtn').classList.remove('hidden');
    document.getElementById('stopSimBtn').classList.add('hidden');
    document.getElementById('progressBar').style.width = '100%';
    const { attempts, matchCount, elapsed } = data;
    if (matchCount > 0) showStatus('success', `ğŸ‰ ì™„ë£Œ! ${formatNumber(attempts)}íšŒ ë¶„ì„, ${matchCount}íšŒ íŒ¨í„´ ë°œê²¬ (${elapsed.toFixed(1)}ì´ˆ)`);
    else { showStatus('info', `âœ… ì™„ë£Œ! ${formatNumber(attempts)}íšŒ ë¶„ì„, íŒ¨í„´ ë¯¸ë°œê²¬ (${elapsed.toFixed(1)}ì´ˆ)`); showPredictionResult(generateRandomNumbers(), attempts, elapsed, true); }
    if (simulationWorker) { simulationWorker.terminate(); simulationWorker = null; }
}

function showPredictionResult(prediction, attempts, elapsed, isRandom = false) {
    renderBalls(prediction, 'predictionBalls');
    document.getElementById('predictionMeta').textContent = isRandom ? `ëœë¤ ìƒì„± | ${formatNumber(attempts)}íšŒ ë¶„ì„ (íŒ¨í„´ ë¯¸ë°œê²¬)` : `ì œ ${currentRound}íšŒ ê¸°ì¤€ | ${formatNumber(attempts)}íšŒì—ì„œ ë°œê²¬ (${elapsed.toFixed(1)}ì´ˆ)`;
    
    const analysis = analyzeNumbers(prediction);
    const score = calculateQualityScore(analysis);
    displayScoreCard('prediction', score, analysis);
    document.getElementById('predictionAnalysisContent').innerHTML = renderDetailedAnalysis(analysis);
    
    const matching = prediction.filter(n => currentWinningNumbers.includes(n));
    if (matching.length > 0) { 
        document.getElementById('matchCount').textContent = matching.length; 
        renderBalls(matching, 'matchingBalls'); 
        
        // ì¼ì¹˜ ë“±ê¸‰ ì •ë³´ ì¶”ê°€
        let gradeInfo = '';
        if (matching.length >= 6) gradeInfo = 'ğŸ† 1ë“± ì¡°ê±´ ì¶©ì¡±! (ëª¨ë“  ë²ˆí˜¸ ì¼ì¹˜)';
        else if (matching.length === 5) gradeInfo = 'ğŸ¥ˆ 3ë“± ì¡°ê±´ ì¶©ì¡±! (ë³´ë„ˆìŠ¤ ë²ˆí˜¸ í™•ì¸ í•„ìš”)';
        else if (matching.length === 4) gradeInfo = 'ğŸ¥‰ 4ë“± ì¡°ê±´ ì¶©ì¡±!';
        else if (matching.length === 3) gradeInfo = 'ğŸ« 5ë“± ì¡°ê±´ ì¶©ì¡±!';
        else gradeInfo = `${matching.length}ê°œ ì¼ì¹˜ (ë‹¹ì²¨ ì¡°ê±´ ë¯¸ë‹¬)`;
        document.getElementById('matchGradeInfo').textContent = gradeInfo;
        
        document.getElementById('matchingSection').classList.remove('hidden'); 
    }
    else document.getElementById('matchingSection').classList.add('hidden');
    document.getElementById('predictionResult').classList.remove('hidden');
}

function updatePredictionList() {
    document.getElementById('predictionCount').textContent = predictions.length;
    const list = document.getElementById('predictionList');
    list.innerHTML = '';
    predictions.forEach((pred, index) => {
        const item = document.createElement('div');
        item.className = 'prediction-item-expanded';
        const ballsHtml = pred.prediction.map(n => `<span class="ball ${getBallClass(n)}" style="width:40px;height:40px;line-height:40px;font-size:0.9rem;">${n}</span>`).join('');
        const matching = pred.prediction.filter(n => currentWinningNumbers.includes(n));
        const analysis = analyzeNumbers(pred.prediction);
        const score = calculateQualityScore(analysis);
        
        // ë“±ê¸‰ ê²°ì •
        let gradeInfo = '', gradeClass = '';
        if (matching.length >= 6) { gradeInfo = 'ğŸ† 1ë“±'; gradeClass = 'grade-jackpot'; }
        else if (matching.length === 5) { gradeInfo = 'ğŸ¥ˆ 3ë“±+'; gradeClass = 'grade-high'; }
        else if (matching.length === 4) { gradeInfo = 'ğŸ¥‰ 4ë“±'; gradeClass = 'grade-mid'; }
        else if (matching.length === 3) { gradeInfo = 'ğŸ« 5ë“±'; gradeClass = 'grade-low'; }
        else { gradeInfo = '-'; gradeClass = ''; }
        
        item.innerHTML = `
            <div class="pred-card">
                <div class="pred-card-header" data-index="${index}">
                    <div class="pred-card-title">
                        <span class="prediction-number">#${pred.matchNum}</span>
                        <div class="pred-score-badge score-${score.gradeClass}">${score.totalScore}ì  (${score.grade})</div>
                        ${matching.length >= 3 ? `<div class="pred-grade-badge ${gradeClass}">${gradeInfo}</div>` : ''}
                    </div>
                    <div class="pred-card-meta">
                        <span>${formatNumber(pred.attempt)}íšŒì—ì„œ ë°œê²¬</span>
                        <span>|</span>
                        <span>${pred.time.toFixed(1)}ì´ˆ</span>
                        <span class="expand-icon" id="expandIcon${index}">â–¼</span>
                    </div>
                </div>
                
                <div class="pred-balls-row">
                    ${ballsHtml}
                </div>
                
                ${matching.length > 0 ? `
                    <div class="pred-match-info">
                        <span class="match-label">âœ“ ë‹¹ì²¨ë²ˆí˜¸ì™€ ì¼ì¹˜:</span>
                        <span class="match-numbers">${matching.join(', ')}</span>
                        <span class="match-count-badge">${matching.length}ê°œ</span>
                    </div>
                ` : `
                    <div class="pred-match-info no-match">
                        <span>ë‹¹ì²¨ë²ˆí˜¸ì™€ ì¼ì¹˜í•˜ëŠ” ë²ˆí˜¸ ì—†ìŒ</span>
                    </div>
                `}
                
                <!-- ê°„ë‹¨ ìš”ì•½ (í•­ìƒ í‘œì‹œ) -->
                <div class="pred-quick-stats">
                    <div class="quick-stat">
                        <span class="quick-stat-label">í•©ê³„</span>
                        <span class="quick-stat-value">${analysis.sum}</span>
                    </div>
                    <div class="quick-stat">
                        <span class="quick-stat-label">ACê°’</span>
                        <span class="quick-stat-value">${analysis.ac}</span>
                    </div>
                    <div class="quick-stat">
                        <span class="quick-stat-label">í™€:ì§</span>
                        <span class="quick-stat-value">${analysis.oddEvenRatio}</span>
                    </div>
                    <div class="quick-stat">
                        <span class="quick-stat-label">ê³ :ì €</span>
                        <span class="quick-stat-value">${analysis.lowHighRatio}</span>
                    </div>
                    <div class="quick-stat">
                        <span class="quick-stat-label">êµ¬ê°„</span>
                        <span class="quick-stat-value">${analysis.sectionsWithNumbers}ê°œ</span>
                    </div>
                </div>
                
                <!-- ìƒì„¸ ë¶„ì„ (í† ê¸€) -->
                <div class="pred-detail-section" id="predDetail${index}" data-open="false" style="display:none; padding:0;">
                    ${renderCompactAnalysis(analysis, score, matching)}
                </div>
                
                <button type="button" class="pred-toggle-btn" data-index="${index}">
                    <span id="toggleText${index}">ìƒì„¸ ë¶„ì„ ë³´ê¸°</span>
                </button>
            </div>
        `;
        list.appendChild(item);
    });
}

function togglePredictionDetail(index) {
    const detail = document.getElementById('predDetail' + index);
    const icon = document.getElementById('expandIcon' + index);
    const text = document.getElementById('toggleText' + index);
    
    if (!detail) {
        console.log('Detail not found for index:', index);
        return;
    }
    
    const isOpen = detail.getAttribute('data-open') === 'true';
    
    if (isOpen) {
        detail.setAttribute('data-open', 'false');
        detail.style.display = 'none';
        detail.style.padding = '0';
        if (icon) icon.style.transform = 'rotate(0deg)';
        if (text) text.textContent = 'ìƒì„¸ ë¶„ì„ ë³´ê¸°';
    } else {
        detail.setAttribute('data-open', 'true');
        detail.style.display = 'block';
        detail.style.padding = '20px';
        if (icon) icon.style.transform = 'rotate(180deg)';
        if (text) text.textContent = 'ìƒì„¸ ë¶„ì„ ì ‘ê¸°';
    }
}

function renderCompactAnalysis(a, score, matching) {
    const getGradeInfo = (value, optimal, good, normal) => {
        if (value >= optimal[0] && value <= optimal[1]) return { class: 'excellent', text: 'ìµœì ', color: 'var(--grade-excellent)' };
        if (value >= good[0] && value <= good[1]) return { class: 'good', text: 'ì–‘í˜¸', color: 'var(--grade-good)' };
        if (value >= normal[0] && value <= normal[1]) return { class: 'normal', text: 'ë³´í†µ', color: 'var(--grade-normal)' };
        return { class: 'caution', text: 'ì£¼ì˜', color: 'var(--grade-caution)' };
    };
    
    const sumGrade = getGradeInfo(a.sum, [115, 150], [100, 175], [80, 200]);
    const acGrade = getGradeInfo(a.ac, [7, 10], [5, 6], [4, 4]);
    const oddEvenDiff = Math.abs(a.oddCount - a.evenCount);
    const oddEvenGrade = getGradeInfo(6 - oddEvenDiff, [4, 6], [2, 3], [1, 1]);
    const lowHighDiff = Math.abs(a.lowCount - a.highCount);
    const lowHighGrade = getGradeInfo(6 - lowHighDiff, [4, 6], [2, 3], [1, 1]);
    const sectionGrade = getGradeInfo(a.sectionsWithNumbers, [4, 5], [3, 3], [2, 2]);
    
    return `
        <!-- ì ìˆ˜ ë¶„í•´ -->
        <div class="detail-section">
            <div class="detail-title">ğŸ“Š í’ˆì§ˆ ì ìˆ˜ ë¶„ì„</div>
            <div class="score-breakdown-detail">
                ${Object.entries(score.breakdown).map(([key, item]) => `
                    <div class="score-bar-item">
                        <div class="score-bar-header">
                            <span>${item.label}</span>
                            <span style="color: ${item.score >= item.max * 0.8 ? 'var(--grade-excellent)' : item.score >= item.max * 0.6 ? 'var(--grade-good)' : 'var(--grade-caution)'}">${item.score}/${item.max}</span>
                        </div>
                        <div class="score-bar-bg">
                            <div class="score-bar-fill" style="width: ${(item.score / item.max) * 100}%; background: ${item.score >= item.max * 0.8 ? 'var(--grade-excellent)' : item.score >= item.max * 0.6 ? 'var(--grade-good)' : 'var(--grade-caution)'}"></div>
                        </div>
                    </div>
                `).join('')}
            </div>
        </div>
        
        <!-- ì¢…í•© í•´ì„ -->
        <div class="detail-section">
            <div class="detail-title">ğŸ“‹ ì¢…í•© í•´ì„</div>
            <div class="detail-interpretation">
                ì´ ë²ˆí˜¸ ì¡°í•©ì€ <strong>í•©ê³„ ${a.sum}</strong> (${sumGrade.text})ì´ë©°, 
                <strong>ACê°’ ${a.ac}</strong> (${acGrade.text})ì…ë‹ˆë‹¤.
                í™€ì§ <strong>${a.oddEvenRatio}</strong> (${oddEvenGrade.text}), 
                ê³ ì € <strong>${a.lowHighRatio}</strong> (${lowHighGrade.text})ë¡œ 
                ${oddEvenDiff <= 2 && lowHighDiff <= 2 ? 'ë§¤ìš° ê· í˜•ì¡íŒ' : oddEvenDiff <= 4 && lowHighDiff <= 4 ? 'ì ì ˆíˆ ë¶„ì‚°ëœ' : 'ë‹¤ì†Œ í¸ì¤‘ëœ'} êµ¬ì„±ì…ë‹ˆë‹¤.
                ${a.consecutiveGroups.length > 0 ? `ì—°ì†ë²ˆí˜¸ ${a.consecutiveGroups.length}ê·¸ë£¹ í¬í•¨.` : ''}
            </div>
        </div>
        
        <!-- ìƒì„¸ ì§€í‘œ -->
        <div class="detail-section">
            <div class="detail-title">ğŸ” ìƒì„¸ ì§€í‘œ</div>
            <div class="detail-metrics-grid">
                <div class="detail-metric">
                    <div class="metric-header">
                        <span class="metric-label">í•©ê³„</span>
                        <span class="metric-grade" style="background: ${sumGrade.color}20; color: ${sumGrade.color}">${sumGrade.text}</span>
                    </div>
                    <div class="metric-value">${a.sum}</div>
                    <div class="metric-range">ê¶Œì¥: 115~150</div>
                    <div class="metric-detail">${a.sum >= 115 && a.sum <= 150 ? 'âœ“ ìµœì  ë²”ìœ„' : a.sum >= 100 && a.sum <= 175 ? 'â—‹ ì ì • ë²”ìœ„' : 'âš ï¸ ë²”ìœ„ ë²—ì–´ë‚¨'}</div>
                </div>
                
                <div class="detail-metric">
                    <div class="metric-header">
                        <span class="metric-label">ACê°’</span>
                        <span class="metric-grade" style="background: ${acGrade.color}20; color: ${acGrade.color}">${acGrade.text}</span>
                    </div>
                    <div class="metric-value">${a.ac}</div>
                    <div class="metric-range">ê¶Œì¥: 7~10</div>
                    <div class="metric-detail">${a.ac >= 7 ? 'âœ“ ë‹¤ì–‘í•œ êµ¬ì„±' : a.ac >= 5 ? 'â—‹ ë³´í†µ êµ¬ì„±' : 'âš ï¸ ë‹¨ì¡°ë¡œìš´ êµ¬ì„±'}</div>
                </div>
                
                <div class="detail-metric">
                    <div class="metric-header">
                        <span class="metric-label">ë²ˆí˜¸ ë²”ìœ„</span>
                    </div>
                    <div class="metric-value">${a.range}</div>
                    <div class="metric-range">${a.numbers[0]} ~ ${a.numbers[5]}</div>
                    <div class="metric-detail">${a.range >= 30 ? 'âœ“ ë„“ì€ ë¶„í¬' : a.range >= 20 ? 'â—‹ ì ë‹¹í•œ ë¶„í¬' : 'âš ï¸ ì¢ì€ ë¶„í¬'}</div>
                </div>
                
                <div class="detail-metric">
                    <div class="metric-header">
                        <span class="metric-label">ëìë¦¬ ì¢…ë¥˜</span>
                    </div>
                    <div class="metric-value">${a.uniqueLastDigits}ê°œ</div>
                    <div class="metric-range">ìµœëŒ€: 6ê°œ</div>
                    <div class="metric-detail">${a.uniqueLastDigits >= 5 ? 'âœ“ ë§¤ìš° ë‹¤ì–‘' : a.uniqueLastDigits >= 4 ? 'â—‹ ì ë‹¹í•¨' : 'âš ï¸ ì¤‘ë³µ ë§ìŒ'}</div>
                </div>
            </div>
        </div>
        
        <!-- í™€ì§/ê³ ì € ë¶„ì„ -->
        <div class="detail-section">
            <div class="detail-title">ğŸ² í™€ì§ & ê³ ì € ë¶„ì„</div>
            <div class="dual-analysis">
                <div class="dual-box">
                    <div class="dual-header">
                        <span>í™€ì§ ë¹„ìœ¨</span>
                        <span class="metric-grade" style="background: ${oddEvenGrade.color}20; color: ${oddEvenGrade.color}">${oddEvenGrade.text}</span>
                    </div>
                    <div class="dual-ratio">${a.oddEvenRatio}</div>
                    <div class="dual-detail">
                        <div>í™€ìˆ˜: <span style="color:var(--accent-pink)">${a.odd.join(', ') || 'ì—†ìŒ'}</span></div>
                        <div>ì§ìˆ˜: <span style="color:var(--accent-cyan)">${a.even.join(', ') || 'ì—†ìŒ'}</span></div>
                    </div>
                </div>
                <div class="dual-box">
                    <div class="dual-header">
                        <span>ê³ ì € ë¹„ìœ¨</span>
                        <span class="metric-grade" style="background: ${lowHighGrade.color}20; color: ${lowHighGrade.color}">${lowHighGrade.text}</span>
                    </div>
                    <div class="dual-ratio">${a.lowHighRatio}</div>
                    <div class="dual-detail">
                        <div>ì €(1-22): <span style="color:#60a5fa">${a.low.join(', ') || 'ì—†ìŒ'}</span></div>
                        <div>ê³ (23-45): <span style="color:#f87171">${a.high.join(', ') || 'ì—†ìŒ'}</span></div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- êµ¬ê°„ ë¶„í¬ -->
        <div class="detail-section">
            <div class="detail-title">ğŸ“ êµ¬ê°„ë³„ ë¶„í¬ 
                <span class="metric-grade" style="background: ${sectionGrade.color}20; color: ${sectionGrade.color}">${a.sectionsWithNumbers}ê°œ êµ¬ê°„ (${sectionGrade.text})</span>
            </div>
            <div class="section-visual">
                <div class="section-bar-detail">
                    <div class="section-seg s1 ${a.sections['1-10'].length > 0 ? 'active' : ''}">
                        <span class="seg-count">${a.sections['1-10'].length}</span>
                        <span class="seg-label">1-10</span>
                    </div>
                    <div class="section-seg s2 ${a.sections['11-20'].length > 0 ? 'active' : ''}">
                        <span class="seg-count">${a.sections['11-20'].length}</span>
                        <span class="seg-label">11-20</span>
                    </div>
                    <div class="section-seg s3 ${a.sections['21-30'].length > 0 ? 'active' : ''}">
                        <span class="seg-count">${a.sections['21-30'].length}</span>
                        <span class="seg-label">21-30</span>
                    </div>
                    <div class="section-seg s4 ${a.sections['31-40'].length > 0 ? 'active' : ''}">
                        <span class="seg-count">${a.sections['31-40'].length}</span>
                        <span class="seg-label">31-40</span>
                    </div>
                    <div class="section-seg s5 ${a.sections['41-45'].length > 0 ? 'active' : ''}">
                        <span class="seg-count">${a.sections['41-45'].length}</span>
                        <span class="seg-label">41-45</span>
                    </div>
                </div>
                <div class="section-numbers">
                    ${Object.entries(a.sections).map(([range, nums]) => 
                        nums.length > 0 ? `<span class="section-num-item">${range}: ${nums.join(', ')}</span>` : ''
                    ).filter(x => x).join('')}
                </div>
            </div>
        </div>
        
        <!-- ì—°ì†ë²ˆí˜¸ & ê°„ê²© -->
        <div class="detail-section">
            <div class="detail-title">ğŸ”— ì—°ì†ë²ˆí˜¸ & ê°„ê²©</div>
            <div class="dual-analysis">
                <div class="dual-box">
                    <div class="dual-header">ì—°ì†ë²ˆí˜¸</div>
                    ${a.consecutiveGroups.length > 0 ? `
                        <div class="consecutive-groups">
                            ${a.consecutiveGroups.map(g => `<span class="consec-group">${g.join('â†’')}</span>`).join('')}
                        </div>
                    ` : '<div style="color:var(--text-secondary);font-size:0.85rem;">ì—†ìŒ</div>'}
                </div>
                <div class="dual-box">
                    <div class="dual-header">ë²ˆí˜¸ ê°„ê²©</div>
                    <div class="gap-stats">
                        <span>ìµœì†Œ: <strong>${a.minGap}</strong></span>
                        <span>ìµœëŒ€: <strong>${a.maxGap}</strong></span>
                        <span>í‰ê· : <strong>${a.avgGap}</strong></span>
                    </div>
                    <div class="gap-sequence">ê°„ê²©: ${a.gaps.join(' â†’ ')}</div>
                </div>
            </div>
        </div>
        
        <!-- ìˆ˜í•™ì  íŠ¹ì„± -->
        <div class="detail-section">
            <div class="detail-title">ğŸ”¬ ìˆ˜í•™ì  íŠ¹ì„±</div>
            <div class="math-props">
                <div class="math-item">
                    <span class="math-label">ì†Œìˆ˜</span>
                    <span class="math-value">${a.primes.length > 0 ? a.primes.join(', ') : 'ì—†ìŒ'} (${a.primes.length}ê°œ)</span>
                </div>
                <div class="math-item">
                    <span class="math-label">3ì˜ ë°°ìˆ˜</span>
                    <span class="math-value">${a.mult3.length > 0 ? a.mult3.join(', ') : 'ì—†ìŒ'} (${a.mult3.length}ê°œ)</span>
                </div>
                <div class="math-item">
                    <span class="math-label">5ì˜ ë°°ìˆ˜</span>
                    <span class="math-value">${a.mult5.length > 0 ? a.mult5.join(', ') : 'ì—†ìŒ'} (${a.mult5.length}ê°œ)</span>
                </div>
            </div>
        </div>
        
        <!-- ë‹¹ì²¨ ê°€ëŠ¥ì„± -->
        ${matching.length >= 3 ? `
        <div class="detail-section prize-section">
            <div class="detail-title">ğŸ† ë‹¹ì²¨ ë“±ê¸‰ ë¶„ì„</div>
            <div class="prize-analysis">
                <div class="prize-current">
                    <span>í˜„ì¬ ì¼ì¹˜</span>
                    <span class="prize-match-count">${matching.length}ê°œ</span>
                </div>
                <div class="prize-breakdown">
                    ${matching.length >= 6 ? '<div class="prize-tier tier-1">ğŸ† 1ë“± ë‹¹ì²¨!</div>' : ''}
                    ${matching.length === 5 ? '<div class="prize-tier tier-3">ğŸ¥ˆ 3ë“± (ë³´ë„ˆìŠ¤ í™•ì¸ ì‹œ 2ë“± ê°€ëŠ¥)</div>' : ''}
                    ${matching.length === 4 ? '<div class="prize-tier tier-4">ğŸ¥‰ 4ë“± ë‹¹ì²¨!</div>' : ''}
                    ${matching.length === 3 ? '<div class="prize-tier tier-5">ğŸ« 5ë“± ë‹¹ì²¨!</div>' : ''}
                </div>
                <div class="matching-balls-detail">
                    <span>ì¼ì¹˜ ë²ˆí˜¸:</span>
                    ${matching.map(n => `<span class="ball ${getBallClass(n)}" style="width:32px;height:32px;line-height:32px;font-size:0.8rem;">${n}</span>`).join('')}
                </div>
            </div>
        </div>
        ` : ''}
    `;
}

function generateRandomNumbers() { const nums = [], pool = Array.from({length: 45}, (_, i) => i + 1); for (let i = 0; i < 6; i++) { const randomArray = new Uint32Array(1); crypto.getRandomValues(randomArray); const idx = randomArray[0] % pool.length; nums.push(pool.splice(idx, 1)[0]); } return nums.sort((a, b) => a - b); }
function showStatus(type, message) { const container = document.getElementById('fetchStatus'); container.className = `status ${type}`; container.textContent = message; container.classList.remove('hidden'); }
function toggleCollapsible(id) { document.getElementById(id).classList.toggle('open'); }
function formatNumber(num) { if (num >= 100000000) return (num / 100000000).toFixed(1) + 'ì–µ'; if (num >= 10000) return (num / 10000).toFixed(0) + 'ë§Œ'; return num.toLocaleString(); }
</script>
</body>
</html>
